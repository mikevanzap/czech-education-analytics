[0m13:47:22.271323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FB36D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4F7204D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FBA34D0>]}


============================== 13:47:22.277324 | 39304323-10bf-4fe4-b4dc-5ce9ed99c195 ==============================
[0m13:47:22.277324 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:47:22.278324 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:47:23.384079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39304323-10bf-4fe4-b4dc-5ce9ed99c195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5006A350>]}
[0m13:47:23.504020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39304323-10bf-4fe4-b4dc-5ce9ed99c195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4C8222D0>]}
[0m13:47:23.504986 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m13:47:23.975261 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:47:23.978263 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:47:23.979265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39304323-10bf-4fe4-b4dc-5ce9ed99c195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB51276FD0>]}
[0m13:47:25.916199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39304323-10bf-4fe4-b4dc-5ce9ed99c195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FB84B90>]}
[0m13:47:26.015130 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m13:47:26.040454 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m13:47:26.061453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39304323-10bf-4fe4-b4dc-5ce9ed99c195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5006B750>]}
[0m13:47:26.062455 [info ] [MainThread]: Found 3 models, 455 macros
[0m13:47:26.063587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39304323-10bf-4fe4-b4dc-5ce9ed99c195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB500C4E10>]}
[0m13:47:26.067635 [info ] [MainThread]: 
[0m13:47:26.068779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:26.069779 [info ] [MainThread]: 
[0m13:47:26.071779 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:47:26.079777 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:47:26.474329 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:47:26.475330 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:47:26.476333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:26.476333 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:47:26.477800 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '39304323-10bf-4fe4-b4dc-5ce9ed99c195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FF0ED90>]}
[0m13:47:26.490866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:26.491905 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m13:47:26.492869 [info ] [MainThread]: 
[0m13:47:26.494869 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:47:26.496868 [error] [MainThread]: Encountered an error:
Runtime Error
  cannot import name 'get_localzone_name' from 'tzlocal' (C:\Users\mikev\anaconda3\Lib\site-packages\tzlocal\__init__.py)
[0m13:47:26.498878 [debug] [MainThread]: Command `dbt run` failed at 13:47:26.498878 after 4.38 seconds
[0m13:47:26.499870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FBD3D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FFF2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FEB6E90>]}
[0m13:47:26.500868 [debug] [MainThread]: Flushing usage events
[0m13:47:27.524367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:52.369757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D4546F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D4595050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D402EED0>]}


============================== 13:49:52.376761 | 575f8a87-e9fc-471e-bf8c-551405b1c4bc ==============================
[0m13:49:52.376761 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:49:52.377756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:49:53.216497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D4A11A90>]}
[0m13:49:53.336793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D1232290>]}
[0m13:49:53.337794 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m13:49:53.751719 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:49:54.059971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:54.059971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:54.098519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D4134750>]}
[0m13:49:54.177728 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m13:49:54.181761 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m13:49:54.204729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D5CAD790>]}
[0m13:49:54.205760 [info ] [MainThread]: Found 3 models, 455 macros
[0m13:49:54.206728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D5CB7F90>]}
[0m13:49:54.210760 [info ] [MainThread]: 
[0m13:49:54.212727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:54.213729 [info ] [MainThread]: 
[0m13:49:54.214722 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:49:54.222314 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:49:54.535685 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:49:54.536686 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:49:54.537686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:54.538686 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:49:54.540689 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D5E66C10>]}
[0m13:49:57.210066 [debug] [ThreadPool]: SQL status: SUCCESS in 2.672 seconds
[0m13:49:57.212062 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:49:57.215725 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m13:49:57.237398 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m13:49:57.237398 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m13:49:57.238513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:59.046988 [debug] [ThreadPool]: SQL status: SUCCESS in 1.808 seconds
[0m13:49:59.050818 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m13:49:59.052414 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m13:49:59.055578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D48F79D0>]}
[0m13:49:59.058597 [debug] [MainThread]: On master: COMMIT
[0m13:49:59.071581 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m13:49:59.073581 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m13:49:59.076584 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m13:49:59.079582 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m13:49:59.087579 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m13:49:59.095583 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m13:49:59.167401 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m13:49:59.171632 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m13:49:59.171632 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates"
      
      
    as (
      SELECT
    nazev_vysoke_skoly,
    region_code,
    CAST(graduate_count AS INTEGER) AS graduate_count,
    field_of_study,
    CAST(year AS INTEGER) AS year
FROM hive.grads.graduates
    )
[0m13:49:59.172634 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:49:59.379429 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_124959_00033_bzhsk
[0m13:49:59.380432 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 16:6: Catalog 'hive' not found", query_id=20251102_124959_00033_bzhsk)
[0m13:49:59.381428 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m13:49:59.382560 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m13:49:59.400876 [debug] [Thread-1 (]: Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 16:6: Catalog 'hive' not found", query_id=20251102_124959_00033_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql
[0m13:49:59.405876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D4A34E90>]}
[0m13:49:59.407879 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model testnamespace.stg_graduates .............. [[31mERROR[0m in 0.33s]
[0m13:49:59.409876 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m13:49:59.411881 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m13:49:59.412880 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.stg_graduates' to be skipped because of status 'error'.  Reason: Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 16:6: Catalog 'hive' not found", query_id=20251102_124959_00033_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql.
[0m13:49:59.413880 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m13:49:59.415912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m13:49:59.415912 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m13:49:59.419911 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m13:49:59.421881 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m13:49:59.429876 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m13:49:59.435440 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m13:49:59.437442 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y,
    -- Derive region_code from coordinates (simplified)
    CASE
        WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
        WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
        ELSE 'OTHER'
    END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m13:49:59.438441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:02.126608 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_124959_00034_bzhsk
[0m13:50:02.128237 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_124959_00034_bzhsk)
[0m13:50:02.129915 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m13:50:02.135231 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m13:50:02.145206 [debug] [Thread-1 (]: Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_124959_00034_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql
[0m13:50:02.147199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '575f8a87-e9fc-471e-bf8c-551405b1c4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D6531B50>]}
[0m13:50:02.149324 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model testnamespace.stg_institutions ........... [[31mERROR[0m in 2.73s]
[0m13:50:02.151426 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m13:50:02.152430 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.stg_institutions' to be skipped because of status 'error'.  Reason: Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_124959_00034_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql.
[0m13:50:02.154426 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m13:50:02.155426 [info ] [Thread-1 (]: 3 of 3 SKIP relation testnamespace.fct_regional_education ...................... [[33mSKIP[0m]
[0m13:50:02.157431 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m13:50:02.162148 [debug] [MainThread]: On master: COMMIT
[0m13:50:02.163148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:02.163148 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m13:50:02.164148 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m13:50:02.165148 [debug] [MainThread]: Connection 'model.czech_education.stg_institutions' was properly closed.
[0m13:50:02.166148 [info ] [MainThread]: 
[0m13:50:02.166148 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m13:50:02.168149 [debug] [MainThread]: Command end result
[0m13:50:02.216490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m13:50:02.219491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m13:50:02.230493 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m13:50:02.231493 [info ] [MainThread]: 
[0m13:50:02.233503 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:50:02.235507 [info ] [MainThread]: 
[0m13:50:02.241492 [error] [MainThread]: [31mFailure in model stg_graduates (models\staging\stg_graduates.sql)[0m
[0m13:50:02.242494 [error] [MainThread]:   Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 16:6: Catalog 'hive' not found", query_id=20251102_124959_00033_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql
[0m13:50:02.243508 [info ] [MainThread]: 
[0m13:50:02.244494 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\staging\stg_graduates.sql
[0m13:50:02.245494 [info ] [MainThread]: 
[0m13:50:02.246495 [error] [MainThread]: [31mFailure in model stg_institutions (models\staging\stg_institutions.sql)[0m
[0m13:50:02.247496 [error] [MainThread]:   Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_124959_00034_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql
[0m13:50:02.248494 [info ] [MainThread]: 
[0m13:50:02.249494 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\staging\stg_institutions.sql
[0m13:50:02.250495 [info ] [MainThread]: 
[0m13:50:02.251495 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=3
[0m13:50:02.254491 [debug] [MainThread]: Command `dbt run` failed at 13:50:02.254491 after 10.01 seconds
[0m13:50:02.259495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D45B3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282CDD65A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D60F13D0>]}
[0m13:50:02.262501 [debug] [MainThread]: Flushing usage events
[0m13:50:04.503848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:11.715139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B2587390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B25CA110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B2586010>]}


============================== 13:51:11.723164 | fe082586-b023-43ba-a49b-1549cea1609c ==============================
[0m13:51:11.723164 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:51:11.726142 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m13:51:12.488208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B2A63B50>]}
[0m13:51:12.624647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169AF26E810>]}
[0m13:51:12.626653 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m13:51:13.051989 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:51:13.297368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:51:13.298368 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\staging\stg_graduates.sql
[0m13:51:13.894091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B2B2D950>]}
[0m13:51:13.973694 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m13:51:13.976696 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m13:51:13.996048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B3DC2190>]}
[0m13:51:13.997053 [info ] [MainThread]: Found 3 models, 455 macros
[0m13:51:13.998050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B3DCD410>]}
[0m13:51:14.004844 [info ] [MainThread]: 
[0m13:51:14.005962 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:14.007655 [info ] [MainThread]: 
[0m13:51:14.008919 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:51:14.018133 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:51:14.335134 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:51:14.336137 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:51:14.337093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:14.338096 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:51:14.339106 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B4094610>]}
[0m13:51:14.607468 [debug] [ThreadPool]: SQL status: SUCCESS in 0.270 seconds
[0m13:51:14.610177 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:51:14.614003 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m13:51:14.643421 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m13:51:14.644421 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m13:51:14.645420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:15.044810 [debug] [ThreadPool]: SQL status: SUCCESS in 0.399 seconds
[0m13:51:15.050649 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m13:51:15.052266 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m13:51:15.058943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B3FCABD0>]}
[0m13:51:15.061532 [debug] [MainThread]: On master: COMMIT
[0m13:51:15.073468 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m13:51:15.076616 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m13:51:15.080646 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m13:51:15.085619 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m13:51:15.096436 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m13:51:15.103433 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m13:51:15.185598 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m13:51:15.188597 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m13:51:15.188597 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates"
      
      
    as (
      SELECT
    nazev_vysoke_skoly,
    region_code,
    CAST(graduate_count AS INTEGER) AS graduate_count,
    field_of_study,
    CAST(year AS INTEGER) AS year
FROM iceberg.testnamespace.graduates
    )
[0m13:51:15.189599 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:51:15.384194 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_125115_00037_bzhsk
[0m13:51:15.388270 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 11:5: Column 'nazev_vysoke_skoly' cannot be resolved", query_id=20251102_125115_00037_bzhsk)
[0m13:51:15.390071 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m13:51:15.391638 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m13:51:15.410313 [debug] [Thread-1 (]: Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 11:5: Column 'nazev_vysoke_skoly' cannot be resolved", query_id=20251102_125115_00037_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql
[0m13:51:15.414312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B2A74ED0>]}
[0m13:51:15.417320 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model testnamespace.stg_graduates .............. [[31mERROR[0m in 0.33s]
[0m13:51:15.422334 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m13:51:15.423317 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m13:51:15.425341 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.stg_graduates' to be skipped because of status 'error'.  Reason: Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 11:5: Column 'nazev_vysoke_skoly' cannot be resolved", query_id=20251102_125115_00037_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql.
[0m13:51:15.427375 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m13:51:15.429319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m13:51:15.430352 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m13:51:15.435443 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m13:51:15.438312 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m13:51:15.444349 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m13:51:15.448347 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m13:51:15.453317 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y,
    -- Derive region_code from coordinates (simplified)
    CASE
        WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
        WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
        ELSE 'OTHER'
    END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m13:51:15.456312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:16.010770 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_125115_00038_bzhsk
[0m13:51:16.012408 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_125115_00038_bzhsk)
[0m13:51:16.014595 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m13:51:16.015724 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m13:51:16.022650 [debug] [Thread-1 (]: Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_125115_00038_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql
[0m13:51:16.023662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe082586-b023-43ba-a49b-1549cea1609c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B2912A10>]}
[0m13:51:16.025661 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model testnamespace.stg_institutions ........... [[31mERROR[0m in 0.59s]
[0m13:51:16.028665 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m13:51:16.031677 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.stg_institutions' to be skipped because of status 'error'.  Reason: Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_125115_00038_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql.
[0m13:51:16.041663 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m13:51:16.044667 [info ] [Thread-1 (]: 3 of 3 SKIP relation testnamespace.fct_regional_education ...................... [[33mSKIP[0m]
[0m13:51:16.047667 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m13:51:16.051684 [debug] [MainThread]: On master: COMMIT
[0m13:51:16.055663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:16.056666 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m13:51:16.057660 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m13:51:16.057660 [debug] [MainThread]: Connection 'model.czech_education.stg_institutions' was properly closed.
[0m13:51:16.059660 [info ] [MainThread]: 
[0m13:51:16.060871 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m13:51:16.069763 [debug] [MainThread]: Command end result
[0m13:51:16.127837 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m13:51:16.131837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m13:51:16.139838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m13:51:16.140938 [info ] [MainThread]: 
[0m13:51:16.142463 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:51:16.145466 [info ] [MainThread]: 
[0m13:51:16.150464 [error] [MainThread]: [31mFailure in model stg_graduates (models\staging\stg_graduates.sql)[0m
[0m13:51:16.151459 [error] [MainThread]:   Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 11:5: Column 'nazev_vysoke_skoly' cannot be resolved", query_id=20251102_125115_00037_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql
[0m13:51:16.152465 [info ] [MainThread]: 
[0m13:51:16.154461 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\staging\stg_graduates.sql
[0m13:51:16.155462 [info ] [MainThread]: 
[0m13:51:16.156461 [error] [MainThread]: [31mFailure in model stg_institutions (models\staging\stg_institutions.sql)[0m
[0m13:51:16.161810 [error] [MainThread]:   Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_125115_00038_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql
[0m13:51:16.164819 [info ] [MainThread]: 
[0m13:51:16.166821 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\staging\stg_institutions.sql
[0m13:51:16.170177 [info ] [MainThread]: 
[0m13:51:16.171146 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=3
[0m13:51:16.176286 [debug] [MainThread]: Command `dbt run` failed at 13:51:16.176286 after 4.60 seconds
[0m13:51:16.178313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ABE666D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ABE66A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B3CD8D90>]}
[0m13:51:16.179412 [debug] [MainThread]: Flushing usage events
[0m13:51:17.380945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:52.443178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65F866C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65F8D3A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65F866810>]}


============================== 14:02:52.453177 | 7e98b03d-2b82-4833-91f1-9aceea173c2a ==============================
[0m14:02:52.453177 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:02:52.455173 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:02:53.406588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65FCF6190>]}
[0m14:02:53.520418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65C54EF10>]}
[0m14:02:53.521419 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:02:54.018956 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:02:54.358475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:02:54.359476 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\staging\stg_graduates.sql
[0m14:02:54.869398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65FE03E50>]}
[0m14:02:54.974662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:02:54.982660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:02:55.010662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6610A0F10>]}
[0m14:02:55.012672 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:02:55.014660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65F85BE50>]}
[0m14:02:55.017658 [info ] [MainThread]: 
[0m14:02:55.018659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:02:55.019658 [info ] [MainThread]: 
[0m14:02:55.021659 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:02:55.033659 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:02:55.435471 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:02:55.436472 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:02:55.437472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:55.437472 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:02:55.439488 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65FFDDA90>]}
[0m14:02:55.632988 [debug] [ThreadPool]: SQL status: SUCCESS in 0.195 seconds
[0m14:02:55.637989 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:02:55.646200 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:02:55.685544 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:02:55.686545 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:02:55.687546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:55.889876 [debug] [ThreadPool]: SQL status: SUCCESS in 0.202 seconds
[0m14:02:55.893208 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:02:55.896270 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:02:55.900940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65C4D0490>]}
[0m14:02:55.901941 [debug] [MainThread]: On master: COMMIT
[0m14:02:55.907939 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:02:55.908940 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:02:55.911967 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:02:55.912947 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:02:55.916941 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:02:55.918939 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:02:55.988938 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:02:55.991939 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:02:55.992939 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:02:55.993938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:02:56.144329 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_130256_00086_bzhsk
[0m14:02:56.146130 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 14:5: Column 'study_program' cannot be resolved", query_id=20251102_130256_00086_bzhsk)
[0m14:02:56.148313 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:02:56.149374 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:02:56.184431 [debug] [Thread-1 (]: Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 14:5: Column 'study_program' cannot be resolved", query_id=20251102_130256_00086_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql
[0m14:02:56.190391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65C7C9F10>]}
[0m14:02:56.192585 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model testnamespace.stg_graduates .............. [[31mERROR[0m in 0.28s]
[0m14:02:56.198363 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:02:56.199976 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:02:56.201021 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.stg_graduates' to be skipped because of status 'error'.  Reason: Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 14:5: Column 'study_program' cannot be resolved", query_id=20251102_130256_00086_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql.
[0m14:02:56.202088 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:02:56.203690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:02:56.205292 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:02:56.210719 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:02:56.216713 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:02:56.224712 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:02:56.231714 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:02:56.232736 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y,
    -- Derive region_code from coordinates (simplified)
    CASE
        WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
        WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
        ELSE 'OTHER'
    END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:02:56.234712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:56.916158 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_130256_00087_bzhsk
[0m14:02:56.917241 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_130256_00087_bzhsk)
[0m14:02:56.918854 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:02:56.919379 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:02:56.924722 [debug] [Thread-1 (]: Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_130256_00087_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql
[0m14:02:56.925777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e98b03d-2b82-4833-91f1-9aceea173c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65FE0D810>]}
[0m14:02:56.927780 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model testnamespace.stg_institutions ........... [[31mERROR[0m in 0.72s]
[0m14:02:56.928775 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:02:56.930777 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.stg_institutions' to be skipped because of status 'error'.  Reason: Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_130256_00087_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql.
[0m14:02:56.931777 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:02:56.932775 [info ] [Thread-1 (]: 3 of 3 SKIP relation testnamespace.fct_regional_education ...................... [[33mSKIP[0m]
[0m14:02:56.933622 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:02:56.935633 [debug] [MainThread]: On master: COMMIT
[0m14:02:56.936633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:56.937634 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:02:56.937634 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:02:56.938633 [debug] [MainThread]: Connection 'model.czech_education.stg_institutions' was properly closed.
[0m14:02:56.938633 [info ] [MainThread]: 
[0m14:02:56.939633 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m14:02:56.941632 [debug] [MainThread]: Command end result
[0m14:02:56.982023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:02:56.986023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:02:56.997021 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:02:56.998021 [info ] [MainThread]: 
[0m14:02:57.000022 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m14:02:57.001021 [info ] [MainThread]: 
[0m14:02:57.003022 [error] [MainThread]: [31mFailure in model stg_graduates (models\staging\stg_graduates.sql)[0m
[0m14:02:57.005032 [error] [MainThread]:   Database Error in model stg_graduates (models\staging\stg_graduates.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 14:5: Column 'study_program' cannot be resolved", query_id=20251102_130256_00086_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_graduates.sql
[0m14:02:57.006024 [info ] [MainThread]: 
[0m14:02:57.008025 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\staging\stg_graduates.sql
[0m14:02:57.015023 [info ] [MainThread]: 
[0m14:02:57.017025 [error] [MainThread]: [31mFailure in model stg_institutions (models\staging\stg_institutions.sql)[0m
[0m14:02:57.019028 [error] [MainThread]:   Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_130256_00087_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql
[0m14:02:57.021024 [info ] [MainThread]: 
[0m14:02:57.023035 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\staging\stg_institutions.sql
[0m14:02:57.033097 [info ] [MainThread]: 
[0m14:02:57.035033 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=3
[0m14:02:57.039026 [debug] [MainThread]: Command `dbt run` failed at 14:02:57.038033 after 4.76 seconds
[0m14:02:57.042025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6590D66D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6590D6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66102A650>]}
[0m14:02:57.046046 [debug] [MainThread]: Flushing usage events
[0m14:02:58.192750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:33.776280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026589FE6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658A053410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658A053250>]}


============================== 14:04:33.784339 | 24ffedb5-fec5-4dc6-a789-5df2d8d095c5 ==============================
[0m14:04:33.784339 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:04:33.785284 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:04:34.655124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658A5029D0>]}
[0m14:04:34.781126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026586CD2150>]}
[0m14:04:34.783127 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:04:35.220443 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:04:35.493062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:35.495025 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\staging\stg_graduates.sql
[0m14:04:35.959240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658A51BC10>]}
[0m14:04:36.037862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:04:36.057047 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:04:36.078048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658B824750>]}
[0m14:04:36.079049 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:04:36.081052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026589FDBCD0>]}
[0m14:04:36.086059 [info ] [MainThread]: 
[0m14:04:36.089057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:36.090051 [info ] [MainThread]: 
[0m14:04:36.092052 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:04:36.102051 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:04:36.440010 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:04:36.441011 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:04:36.442012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:36.442012 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:04:36.444012 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658B8492D0>]}
[0m14:04:36.616567 [debug] [ThreadPool]: SQL status: SUCCESS in 0.174 seconds
[0m14:04:36.619194 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:04:36.622423 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:04:36.652652 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:04:36.653654 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:04:36.654689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:36.835575 [debug] [ThreadPool]: SQL status: SUCCESS in 0.181 seconds
[0m14:04:36.839952 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:04:36.841580 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:04:36.847043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658BA4FF10>]}
[0m14:04:36.849059 [debug] [MainThread]: On master: COMMIT
[0m14:04:36.856037 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:04:36.858038 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:04:36.863053 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:04:36.870039 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:04:36.877037 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:04:36.881037 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:04:36.952044 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:04:36.955035 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:04:36.956036 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:04:36.957036 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:37.866136 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.909 seconds
[0m14:04:37.895990 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:04:37.896985 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:04:37.900985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026586CD3290>]}
[0m14:04:37.902018 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.04s]
[0m14:04:37.903983 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:04:37.905983 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:04:37.906989 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:04:37.909994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:04:37.912989 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:04:37.917983 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:04:37.918984 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:04:37.923983 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:04:37.930980 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:04:37.931986 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y,
    -- Derive region_code from coordinates (simplified)
    CASE
        WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
        WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
        ELSE 'OTHER'
    END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:04:37.931986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:38.427226 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_130438_00091_bzhsk
[0m14:04:38.427760 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_130438_00091_bzhsk)
[0m14:04:38.428848 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:04:38.429927 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:04:38.449249 [debug] [Thread-1 (]: Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_130438_00091_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql
[0m14:04:38.451246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ffedb5-fec5-4dc6-a789-5df2d8d095c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658A510210>]}
[0m14:04:38.452246 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model testnamespace.stg_institutions ........... [[31mERROR[0m in 0.54s]
[0m14:04:38.454247 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:04:38.455255 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.stg_institutions' to be skipped because of status 'error'.  Reason: Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_130438_00091_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql.
[0m14:04:38.459258 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:04:38.464249 [info ] [Thread-1 (]: 3 of 3 SKIP relation testnamespace.fct_regional_education ...................... [[33mSKIP[0m]
[0m14:04:38.466249 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:04:38.468248 [debug] [MainThread]: On master: COMMIT
[0m14:04:38.469248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:38.469248 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:04:38.470248 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:04:38.470248 [debug] [MainThread]: Connection 'model.czech_education.stg_institutions' was properly closed.
[0m14:04:38.471248 [info ] [MainThread]: 
[0m14:04:38.472247 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m14:04:38.475248 [debug] [MainThread]: Command end result
[0m14:04:38.525439 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:04:38.530434 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:04:38.539433 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:04:38.540435 [info ] [MainThread]: 
[0m14:04:38.542445 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:04:38.545467 [info ] [MainThread]: 
[0m14:04:38.549446 [error] [MainThread]: [31mFailure in model stg_institutions (models\staging\stg_institutions.sql)[0m
[0m14:04:38.551438 [error] [MainThread]:   Database Error in model stg_institutions (models\staging\stg_institutions.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 17:16: Cannot check if varchar is BETWEEN integer and integer", query_id=20251102_130438_00091_bzhsk)
  compiled code at target\run\czech_education\models\staging\stg_institutions.sql
[0m14:04:38.553435 [info ] [MainThread]: 
[0m14:04:38.555442 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\staging\stg_institutions.sql
[0m14:04:38.556441 [info ] [MainThread]: 
[0m14:04:38.558439 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m14:04:38.568456 [debug] [MainThread]: Command `dbt run` failed at 14:04:38.567446 after 4.95 seconds
[0m14:04:38.569447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265838A66D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265838A5A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026588B5D1D0>]}
[0m14:04:38.570446 [debug] [MainThread]: Flushing usage events
[0m14:04:39.716792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:30.764757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028985856D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289858C33D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002898589A290>]}


============================== 14:05:30.770755 | 0c1726fd-ca1a-4bfe-a868-629395a605a6 ==============================
[0m14:05:30.770755 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:05:30.772761 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:05:31.711288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289858D2050>]}
[0m14:05:31.824731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002898253E3D0>]}
[0m14:05:31.825732 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:05:32.238450 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:05:32.508572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:32.509572 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\staging\stg_institutions.sql
[0m14:05:32.958970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289870C9050>]}
[0m14:05:33.048133 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:05:33.053132 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:05:33.074137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028987090A10>]}
[0m14:05:33.075142 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:05:33.077135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002898584B810>]}
[0m14:05:33.083136 [info ] [MainThread]: 
[0m14:05:33.084145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:33.086133 [info ] [MainThread]: 
[0m14:05:33.088140 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:05:33.099132 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:05:33.453812 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:05:33.454810 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:05:33.454810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:33.455775 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:05:33.456769 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002898762CA10>]}
[0m14:05:33.628776 [debug] [ThreadPool]: SQL status: SUCCESS in 0.173 seconds
[0m14:05:33.632166 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:05:33.634979 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:05:33.664037 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:05:33.665073 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:05:33.666041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:33.849554 [debug] [ThreadPool]: SQL status: SUCCESS in 0.183 seconds
[0m14:05:33.855062 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:05:33.857417 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:05:33.866116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289871CC490>]}
[0m14:05:33.868881 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.877495 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:05:33.878490 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:05:33.881495 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:05:33.884495 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:05:33.898493 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:05:33.901493 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:05:33.984049 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:05:33.986086 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:05:33.988084 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:05:33.988084 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:34.815397 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.826 seconds
[0m14:05:34.826685 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:05:34.827754 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:05:35.343761 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.515 seconds
[0m14:05:35.349551 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:05:35.350167 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m14:05:35.534351 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.183 seconds
[0m14:05:35.553112 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:05:35.559781 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:05:35.560839 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:05:35.745426 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.183 seconds
[0m14:05:35.778667 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:05:35.779742 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:05:35.784688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028987289290>]}
[0m14:05:35.788181 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.90s]
[0m14:05:35.792294 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:05:35.795300 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:05:35.796856 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:05:35.798851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:05:35.799856 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:05:35.807878 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:05:35.809853 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:05:35.816429 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:05:35.819428 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:05:35.820429 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:05:35.821428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:36.878948 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 1.057 seconds
[0m14:05:36.884012 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:05:36.886261 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:05:36.888452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028985E2C210>]}
[0m14:05:36.893285 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 1.09s]
[0m14:05:36.896277 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:05:36.898290 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:05:36.902956 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m14:05:36.907976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m14:05:36.912977 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m14:05:36.920948 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m14:05:36.928011 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m14:05:36.935946 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m14:05:36.946941 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:05:36.948942 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        region_code,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT field_of_study) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1
),
institutions_by_region AS (
    SELECT
        region_code,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1
)

SELECT
    i.region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g USING (region_code)
    )
[0m14:05:36.950942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:37.050502 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_130537_00099_bzhsk
[0m14:05:37.051606 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 12:9: Column 'region_code' cannot be resolved", query_id=20251102_130537_00099_bzhsk)
[0m14:05:37.052695 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m14:05:37.053770 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m14:05:37.082882 [debug] [Thread-1 (]: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 12:9: Column 'region_code' cannot be resolved", query_id=20251102_130537_00099_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:05:37.085126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1726fd-ca1a-4bfe-a868-629395a605a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028985CE5550>]}
[0m14:05:37.087880 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model testnamespace.fct_regional_education ..... [[31mERROR[0m in 0.18s]
[0m14:05:37.094636 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:05:37.098120 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.fct_regional_education' to be skipped because of status 'error'.  Reason: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 12:9: Column 'region_code' cannot be resolved", query_id=20251102_130537_00099_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql.
[0m14:05:37.102323 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.103900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:37.104461 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:05:37.104978 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:05:37.105982 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m14:05:37.108991 [info ] [MainThread]: 
[0m14:05:37.109981 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m14:05:37.111979 [debug] [MainThread]: Command end result
[0m14:05:37.156728 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:05:37.160007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:05:37.168965 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:05:37.169969 [info ] [MainThread]: 
[0m14:05:37.170970 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:05:37.177259 [info ] [MainThread]: 
[0m14:05:37.178259 [error] [MainThread]: [31mFailure in model fct_regional_education (models\marts\fct_regional_education.sql)[0m
[0m14:05:37.180258 [error] [MainThread]:   Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 12:9: Column 'region_code' cannot be resolved", query_id=20251102_130537_00099_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:05:37.182258 [info ] [MainThread]: 
[0m14:05:37.182890 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\marts\fct_regional_education.sql
[0m14:05:37.183904 [info ] [MainThread]: 
[0m14:05:37.185904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:05:37.186904 [debug] [MainThread]: Command `dbt run` failed at 14:05:37.186904 after 6.59 seconds
[0m14:05:37.187937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289FF0C66D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289FF0C6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289875F34D0>]}
[0m14:05:37.188909 [debug] [MainThread]: Flushing usage events
[0m14:05:38.303511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:01.081321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4AD86FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4ADC63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4ADC6050>]}


============================== 14:12:01.086313 | fe9885f5-714e-463a-a991-fa5cd6f8144f ==============================
[0m14:12:01.086313 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:12:01.088693 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:12:01.895518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4B2E75D0>]}
[0m14:12:02.016317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F47A71ED0>]}
[0m14:12:02.018317 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:12:02.416686 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:12:02.693117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:02.694115 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\marts\fct_regional_education.sql
[0m14:12:03.131610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4A680810>]}
[0m14:12:03.209120 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:12:03.212119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:12:03.229119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C5CDC90>]}
[0m14:12:03.230119 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:12:03.231121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C6FB5D0>]}
[0m14:12:03.234122 [info ] [MainThread]: 
[0m14:12:03.249455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:03.251448 [info ] [MainThread]: 
[0m14:12:03.254446 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:12:03.266446 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:12:03.589429 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:12:03.590423 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:12:03.590423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:03.591399 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:12:03.592394 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C5A9150>]}
[0m14:12:03.802124 [debug] [ThreadPool]: SQL status: SUCCESS in 0.211 seconds
[0m14:12:03.805344 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:12:03.809767 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:12:03.839216 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:12:03.840219 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:12:03.843218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:04.012596 [debug] [ThreadPool]: SQL status: SUCCESS in 0.169 seconds
[0m14:12:04.015880 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:12:04.016932 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:12:04.020725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4B10DD50>]}
[0m14:12:04.021778 [debug] [MainThread]: On master: COMMIT
[0m14:12:04.029759 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:12:04.030767 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:12:04.032854 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:12:04.033847 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:12:04.041618 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:12:04.044616 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:12:04.119890 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:12:04.122934 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:12:04.123886 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:12:04.123886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:04.779317 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.654 seconds
[0m14:12:04.789423 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:12:04.790476 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:12:05.097061 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.305 seconds
[0m14:12:05.116056 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:12:05.118055 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m14:12:05.417663 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.297 seconds
[0m14:12:05.450655 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:12:05.462071 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:12:05.464230 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:12:05.574691 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.109 seconds
[0m14:12:05.612107 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:12:05.612669 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:12:05.616989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C6D83D0>]}
[0m14:12:05.618977 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.58s]
[0m14:12:05.624528 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:12:05.627530 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:12:05.629083 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:12:05.631088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:12:05.635087 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:12:05.669473 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:12:05.673809 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:12:05.690629 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:12:05.697631 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:12:05.698633 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:12:05.700631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:06.867559 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 1.167 seconds
[0m14:12:06.874772 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:12:06.877455 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:12:07.063723 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.185 seconds
[0m14:12:07.069559 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:12:07.071111 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m14:12:07.229053 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.157 seconds
[0m14:12:07.237337 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:12:07.240017 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:12:07.242641 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:12:07.380178 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.134 seconds
[0m14:12:07.384197 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:12:07.385260 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:12:07.387433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C5618D0>]}
[0m14:12:07.389021 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 1.76s]
[0m14:12:07.395006 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:12:07.399694 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:12:07.402497 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m14:12:07.404011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m14:12:07.408015 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m14:12:07.417564 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m14:12:07.419155 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m14:12:07.428715 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m14:12:07.440902 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:12:07.444892 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT field_of_study) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        region_code,
        institution_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1,2
)

SELECT
    i.region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=  i.institution_name
    )
[0m14:12:07.446888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:07.564352 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_131207_00110_bzhsk
[0m14:12:07.565960 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:24: Column 'field_of_study' cannot be resolved", query_id=20251102_131207_00110_bzhsk)
[0m14:12:07.568183 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m14:12:07.569788 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m14:12:07.590101 [debug] [Thread-1 (]: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:24: Column 'field_of_study' cannot be resolved", query_id=20251102_131207_00110_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:12:07.594617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe9885f5-714e-463a-a991-fa5cd6f8144f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4B16E6D0>]}
[0m14:12:07.596613 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model testnamespace.fct_regional_education ..... [[31mERROR[0m in 0.19s]
[0m14:12:07.598955 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:12:07.601954 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.fct_regional_education' to be skipped because of status 'error'.  Reason: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:24: Column 'field_of_study' cannot be resolved", query_id=20251102_131207_00110_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql.
[0m14:12:07.604094 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.607109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:07.610099 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:12:07.612094 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:12:07.613390 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m14:12:07.614394 [info ] [MainThread]: 
[0m14:12:07.615392 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m14:12:07.618391 [debug] [MainThread]: Command end result
[0m14:12:07.664392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:12:07.669251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:12:07.680400 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:12:07.681467 [info ] [MainThread]: 
[0m14:12:07.682474 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:12:07.685474 [info ] [MainThread]: 
[0m14:12:07.690795 [error] [MainThread]: [31mFailure in model fct_regional_education (models\marts\fct_regional_education.sql)[0m
[0m14:12:07.694017 [error] [MainThread]:   Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:24: Column 'field_of_study' cannot be resolved", query_id=20251102_131207_00110_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:12:07.695015 [info ] [MainThread]: 
[0m14:12:07.696012 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\marts\fct_regional_education.sql
[0m14:12:07.698013 [info ] [MainThread]: 
[0m14:12:07.699014 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:12:07.701133 [debug] [MainThread]: Command `dbt run` failed at 14:12:07.701133 after 6.79 seconds
[0m14:12:07.702213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4A974BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4AD8C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F49AC49D0>]}
[0m14:12:07.703214 [debug] [MainThread]: Flushing usage events
[0m14:12:08.756206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:57.530968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200169D6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020016A25490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020016A188D0>]}


============================== 14:12:57.537968 | 3ad8a08f-977f-42d5-ab24-c475e0027072 ==============================
[0m14:12:57.537968 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:12:57.539973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:12:58.297765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020016EEEF10>]}
[0m14:12:58.408862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200136BEA50>]}
[0m14:12:58.409864 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:12:58.805100 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:12:59.042772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:59.043772 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\marts\fct_regional_education.sql
[0m14:12:59.457205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020016F01910>]}
[0m14:12:59.546495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:12:59.549493 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:12:59.566201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001821D7D0>]}
[0m14:12:59.567202 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:12:59.568236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200169CB7D0>]}
[0m14:12:59.572784 [info ] [MainThread]: 
[0m14:12:59.576772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:59.577771 [info ] [MainThread]: 
[0m14:12:59.578894 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:12:59.586013 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:12:59.892061 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:12:59.893069 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:12:59.893069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:59.894022 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:12:59.895023 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001830DA90>]}
[0m14:13:00.052091 [debug] [ThreadPool]: SQL status: SUCCESS in 0.158 seconds
[0m14:13:00.055229 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:13:00.062538 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:13:00.088801 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:13:00.089799 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:13:00.090798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:00.233478 [debug] [ThreadPool]: SQL status: SUCCESS in 0.143 seconds
[0m14:13:00.236707 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:13:00.237777 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:13:00.245286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020016D59290>]}
[0m14:13:00.246303 [debug] [MainThread]: On master: COMMIT
[0m14:13:00.250923 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:13:00.251923 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:13:00.253930 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:13:00.254930 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:13:00.262936 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:13:00.265923 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:13:00.341489 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:13:00.344490 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:13:00.344490 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:13:00.345490 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:01.034641 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.688 seconds
[0m14:13:01.050134 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:13:01.052365 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:13:01.228633 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.175 seconds
[0m14:13:01.234440 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:13:01.236087 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m14:13:01.439125 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.202 seconds
[0m14:13:01.448570 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:13:01.454024 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:13:01.456246 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:13:01.570024 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.112 seconds
[0m14:13:01.633484 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:13:01.634013 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:13:01.643019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200137A8610>]}
[0m14:13:01.645153 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.38s]
[0m14:13:01.646758 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:13:01.647834 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:13:01.649450 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:13:01.653378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:13:01.655027 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:13:01.664474 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:13:01.666478 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:13:01.673484 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:13:01.678476 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:13:01.680475 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:13:01.681475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:02.724103 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 1.042 seconds
[0m14:13:02.731106 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:13:02.732882 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:13:02.865925 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.131 seconds
[0m14:13:02.872120 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:13:02.873188 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m14:13:03.082672 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.209 seconds
[0m14:13:03.093845 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:13:03.096515 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:13:03.098096 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:13:03.200094 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.101 seconds
[0m14:13:03.202886 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:13:03.203943 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:13:03.206923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020016F6B310>]}
[0m14:13:03.209839 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 1.55s]
[0m14:13:03.211813 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:13:03.213821 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:13:03.215812 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m14:13:03.219813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m14:13:03.222826 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m14:13:03.228824 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m14:13:03.231937 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m14:13:03.237923 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m14:13:03.250672 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:13:03.251731 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        region_code,
        institution_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1,2
)

SELECT
    i.region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=  i.institution_name
    )
[0m14:13:03.252847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:03.384488 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_131303_00121_bzhsk
[0m14:13:03.386129 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 21:9: Column 'region_code' cannot be resolved", query_id=20251102_131303_00121_bzhsk)
[0m14:13:03.392504 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m14:13:03.394728 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m14:13:03.429324 [debug] [Thread-1 (]: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 21:9: Column 'region_code' cannot be resolved", query_id=20251102_131303_00121_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:13:03.434789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ad8a08f-977f-42d5-ab24-c475e0027072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200184D63D0>]}
[0m14:13:03.436908 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model testnamespace.fct_regional_education ..... [[31mERROR[0m in 0.21s]
[0m14:13:03.440147 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:13:03.442845 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.fct_regional_education' to be skipped because of status 'error'.  Reason: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 21:9: Column 'region_code' cannot be resolved", query_id=20251102_131303_00121_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql.
[0m14:13:03.445588 [debug] [MainThread]: On master: COMMIT
[0m14:13:03.450085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:03.452892 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:13:03.454482 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:13:03.455540 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m14:13:03.458034 [info ] [MainThread]: 
[0m14:13:03.461312 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m14:13:03.465243 [debug] [MainThread]: Command end result
[0m14:13:03.537733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:13:03.542735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:13:03.555735 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:13:03.556731 [info ] [MainThread]: 
[0m14:13:03.557733 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:13:03.560312 [info ] [MainThread]: 
[0m14:13:03.565307 [error] [MainThread]: [31mFailure in model fct_regional_education (models\marts\fct_regional_education.sql)[0m
[0m14:13:03.566303 [error] [MainThread]:   Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 21:9: Column 'region_code' cannot be resolved", query_id=20251102_131303_00121_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:13:03.567302 [info ] [MainThread]: 
[0m14:13:03.568961 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\marts\fct_regional_education.sql
[0m14:13:03.575991 [info ] [MainThread]: 
[0m14:13:03.577990 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:13:03.580006 [debug] [MainThread]: Command `dbt run` failed at 14:13:03.578973 after 6.19 seconds
[0m14:13:03.580006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200102866D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200102865D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020018202250>]}
[0m14:13:03.580971 [debug] [MainThread]: Flushing usage events
[0m14:13:04.617802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:43.104948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A88306B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A87DEC450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A88373CD0>]}


============================== 14:13:43.110949 | 8dddd366-1632-4b13-8b5b-597cd35974f5 ==============================
[0m14:13:43.110949 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:13:43.111949 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m14:13:43.846845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A887A4510>]}
[0m14:13:43.957516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A84FEE050>]}
[0m14:13:43.959475 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:13:44.355346 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:13:44.596925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:44.598926 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\marts\fct_regional_education.sql
[0m14:13:45.010188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A89A54950>]}
[0m14:13:45.105730 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:13:45.108860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:13:45.125817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A89B44650>]}
[0m14:13:45.126817 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:13:45.128995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A882FB790>]}
[0m14:13:45.132213 [info ] [MainThread]: 
[0m14:13:45.135223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:45.136286 [info ] [MainThread]: 
[0m14:13:45.137319 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:13:45.145899 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:13:45.434889 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:13:45.435888 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:13:45.435888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:45.436851 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:13:45.437863 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A89E2B150>]}
[0m14:13:45.607408 [debug] [ThreadPool]: SQL status: SUCCESS in 0.171 seconds
[0m14:13:45.609409 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:13:45.613406 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:13:45.646405 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:13:45.647407 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:13:45.647407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:45.781962 [debug] [ThreadPool]: SQL status: SUCCESS in 0.133 seconds
[0m14:13:45.785753 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:13:45.786856 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:13:45.795327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A89D05B90>]}
[0m14:13:45.796995 [debug] [MainThread]: On master: COMMIT
[0m14:13:45.802522 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:13:45.803522 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:13:45.804522 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:13:45.807530 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:13:45.817522 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:13:45.818524 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:13:45.902168 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:13:45.905168 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:13:45.906167 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:13:45.907167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:46.576184 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.669 seconds
[0m14:13:46.585649 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:13:46.586763 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:13:46.751718 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.164 seconds
[0m14:13:46.758191 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:13:46.761965 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m14:13:46.979551 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.217 seconds
[0m14:13:46.994530 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:13:46.999771 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:13:47.000819 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:13:47.093958 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.092 seconds
[0m14:13:47.123116 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:13:47.124842 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:13:47.130243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A84FD41D0>]}
[0m14:13:47.131265 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.32s]
[0m14:13:47.133312 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:13:47.134314 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:13:47.136314 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:13:47.140956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:13:47.144197 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:13:47.151350 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:13:47.152352 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:13:47.163327 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:13:47.168304 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:13:47.169302 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:13:47.170396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:48.010452 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 0.840 seconds
[0m14:13:48.015956 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:13:48.017558 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:13:48.134368 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.116 seconds
[0m14:13:48.141140 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:13:48.143997 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m14:13:48.329855 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.184 seconds
[0m14:13:48.341615 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:13:48.345165 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:13:48.347444 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:13:48.464253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.115 seconds
[0m14:13:48.472123 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:13:48.477170 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:13:48.480277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A8886DB50>]}
[0m14:13:48.484387 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 1.34s]
[0m14:13:48.493166 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:13:48.497111 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:13:48.499113 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m14:13:48.501122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m14:13:48.502116 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m14:13:48.510111 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m14:13:48.513119 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m14:13:48.520111 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m14:13:48.563290 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:13:48.565557 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        institution_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=  i.institution_name
    )
[0m14:13:48.567379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:48.686923 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_131348_00132_bzhsk
[0m14:13:48.688520 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 29:5: Column 'g.region_code' cannot be resolved", query_id=20251102_131348_00132_bzhsk)
[0m14:13:48.693588 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m14:13:48.695586 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m14:13:48.726035 [debug] [Thread-1 (]: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 29:5: Column 'g.region_code' cannot be resolved", query_id=20251102_131348_00132_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:13:48.728907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dddd366-1632-4b13-8b5b-597cd35974f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A886C9E90>]}
[0m14:13:48.731798 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model testnamespace.fct_regional_education ..... [[31mERROR[0m in 0.23s]
[0m14:13:48.735497 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:13:48.742831 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.fct_regional_education' to be skipped because of status 'error'.  Reason: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 29:5: Column 'g.region_code' cannot be resolved", query_id=20251102_131348_00132_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql.
[0m14:13:48.750696 [debug] [MainThread]: On master: COMMIT
[0m14:13:48.752343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:48.753410 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:13:48.754536 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:13:48.755570 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m14:13:48.759643 [info ] [MainThread]: 
[0m14:13:48.763747 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m14:13:48.771508 [debug] [MainThread]: Command end result
[0m14:13:48.834021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:13:48.838023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:13:48.849019 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:13:48.850019 [info ] [MainThread]: 
[0m14:13:48.851027 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:13:48.855035 [info ] [MainThread]: 
[0m14:13:48.858023 [error] [MainThread]: [31mFailure in model fct_regional_education (models\marts\fct_regional_education.sql)[0m
[0m14:13:48.859020 [error] [MainThread]:   Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 29:5: Column 'g.region_code' cannot be resolved", query_id=20251102_131348_00132_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:13:48.860020 [info ] [MainThread]: 
[0m14:13:48.861020 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\marts\fct_regional_education.sql
[0m14:13:48.862022 [info ] [MainThread]: 
[0m14:13:48.863020 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:13:48.865022 [debug] [MainThread]: Command `dbt run` failed at 14:13:48.865022 after 5.90 seconds
[0m14:13:48.865022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A81B266D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A81B26A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A84520190>]}
[0m14:13:48.866020 [debug] [MainThread]: Flushing usage events
[0m14:13:49.946079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:07.307444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004FB76E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004FBE3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004FBE3E10>]}


============================== 14:14:07.312813 | 7cf6f9a5-18d7-4196-9ebf-ed2765772373 ==============================
[0m14:14:07.312813 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:14:07.314785 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:14:08.057088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200500A9C10>]}
[0m14:14:08.167266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004C85E8D0>]}
[0m14:14:08.169225 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:14:08.594233 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:14:08.860206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:14:08.861210 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\marts\fct_regional_education.sql
[0m14:14:09.371674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004CE29450>]}
[0m14:14:09.461713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:14:09.465549 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:14:09.484371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200513C1F90>]}
[0m14:14:09.485443 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:14:09.487084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005152D190>]}
[0m14:14:09.491888 [info ] [MainThread]: 
[0m14:14:09.494453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:09.495000 [info ] [MainThread]: 
[0m14:14:09.496042 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:14:09.505438 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:14:09.824154 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:14:09.825155 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:14:09.825155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:09.826120 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:14:09.828132 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200515BED90>]}
[0m14:14:09.973678 [debug] [ThreadPool]: SQL status: SUCCESS in 0.148 seconds
[0m14:14:09.975267 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:14:09.978431 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:14:10.007283 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:14:10.008268 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:14:10.009234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:10.176809 [debug] [ThreadPool]: SQL status: SUCCESS in 0.167 seconds
[0m14:14:10.180098 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:14:10.181275 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:14:10.190296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005164B390>]}
[0m14:14:10.192027 [debug] [MainThread]: On master: COMMIT
[0m14:14:10.198023 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:14:10.201027 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:14:10.204028 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:14:10.206027 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:14:10.216026 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:14:10.218024 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:14:10.287056 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:14:10.290059 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:14:10.290059 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:14:10.291056 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:10.876575 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.585 seconds
[0m14:14:10.886224 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:14:10.887309 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:14:11.090180 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.202 seconds
[0m14:14:11.096550 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:14:11.097600 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m14:14:11.319087 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.220 seconds
[0m14:14:11.331935 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:14:11.338522 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:14:11.339664 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:14:11.497083 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.156 seconds
[0m14:14:11.571894 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:14:11.573502 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:14:11.582942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005130F010>]}
[0m14:14:11.585948 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.37s]
[0m14:14:11.589537 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:14:11.594150 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:14:11.599789 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:14:11.606783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:14:11.608785 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:14:11.630261 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:14:11.636007 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:14:11.653193 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:14:11.660734 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:14:11.663330 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:14:11.665561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:12.580229 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 0.915 seconds
[0m14:14:12.586630 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:14:12.587688 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:14:12.770990 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.182 seconds
[0m14:14:12.779992 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:14:12.784771 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m14:14:12.938689 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.152 seconds
[0m14:14:12.945432 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:14:12.947457 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:14:12.952021 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:14:13.061602 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.108 seconds
[0m14:14:13.069245 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:14:13.070847 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:14:13.073084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004C868990>]}
[0m14:14:13.075211 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 1.47s]
[0m14:14:13.077359 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:14:13.080260 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:14:13.088109 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m14:14:13.091734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m14:14:13.096685 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m14:14:13.109741 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m14:14:13.112439 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m14:14:13.128515 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m14:14:13.136068 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:14:13.136632 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        institution_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=  i.institution_name
    )
[0m14:14:13.137677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:14.456347 [debug] [Thread-1 (]: SQL status: CREATE TABLE (237 rows) in 1.319 seconds
[0m14:14:14.461399 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m14:14:14.462401 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m14:14:14.466948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cf6f9a5-18d7-4196-9ebf-ed2765772373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020050149150>]}
[0m14:14:14.469757 [info ] [Thread-1 (]: 3 of 3 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (237 rows)[0m in 1.37s]
[0m14:14:14.472105 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:14:14.477820 [debug] [MainThread]: On master: COMMIT
[0m14:14:14.481256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:14.485700 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:14:14.488107 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:14:14.489448 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m14:14:14.491736 [info ] [MainThread]: 
[0m14:14:14.493372 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m14:14:14.499892 [debug] [MainThread]: Command end result
[0m14:14:14.535484 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:14:14.540485 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:14:14.548559 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:14:14.549661 [info ] [MainThread]: 
[0m14:14:14.550663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:14.552772 [info ] [MainThread]: 
[0m14:14:14.557771 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:14:14.559806 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:14.559806 after 7.37 seconds
[0m14:14:14.560771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200493B65D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200493B58D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200493B6590>]}
[0m14:14:14.560771 [debug] [MainThread]: Flushing usage events
[0m14:14:15.657573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:53.131301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB4866F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB48A6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB48A7110>]}


============================== 14:25:53.141346 | c6462c50-409a-42d0-b03b-218955a3a144 ==============================
[0m14:25:53.141346 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:53.142301 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:25:54.255634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB4D7EF10>]}
[0m14:25:54.410932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB153E690>]}
[0m14:25:54.412962 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:25:54.896353 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:25:55.273509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:55.275510 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\marts\fct_regional_education.sql
[0m14:25:55.763024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB5FE8510>]}
[0m14:25:55.875654 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:25:55.880445 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:25:55.907035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB60AEA10>]}
[0m14:25:55.909036 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:25:55.910107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB4895110>]}
[0m14:25:55.914078 [info ] [MainThread]: 
[0m14:25:55.917159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:55.919175 [info ] [MainThread]: 
[0m14:25:55.920170 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:25:55.928023 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:25:56.356203 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:25:56.357203 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:25:56.358203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:56.359204 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:25:56.360203 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB61D5990>]}
[0m14:25:56.753085 [debug] [ThreadPool]: SQL status: SUCCESS in 0.394 seconds
[0m14:25:56.761148 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:25:56.766323 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:25:56.800884 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:25:56.803884 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:25:56.805886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:57.025356 [debug] [ThreadPool]: SQL status: SUCCESS in 0.219 seconds
[0m14:25:57.028346 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:25:57.029354 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:25:57.037347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB61C9190>]}
[0m14:25:57.038347 [debug] [MainThread]: On master: COMMIT
[0m14:25:57.044347 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:25:57.046351 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:25:57.050373 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:25:57.052349 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:25:57.057346 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:25:57.059347 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:25:57.128930 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:25:57.131898 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:25:57.132933 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:25:57.133939 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:58.335585 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 1.202 seconds
[0m14:25:58.354117 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:25:58.355122 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:25:58.496658 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.140 seconds
[0m14:25:58.510045 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:25:58.512318 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m14:25:58.748475 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.231 seconds
[0m14:25:58.762025 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:25:58.775029 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:25:58.777025 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:25:58.931488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.151 seconds
[0m14:25:58.987594 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:25:58.990603 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:25:58.996588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB4A9E1D0>]}
[0m14:25:58.997587 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.94s]
[0m14:25:58.999591 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:25:59.001588 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:25:59.002588 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:25:59.004588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:25:59.006611 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:25:59.020586 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:25:59.023587 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:25:59.035150 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:25:59.039151 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:25:59.040150 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:25:59.041151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:00.601233 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 1.560 seconds
[0m14:26:00.607652 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:26:00.610451 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:26:00.776726 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.165 seconds
[0m14:26:00.787884 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:26:00.788940 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m14:26:00.924752 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.135 seconds
[0m14:26:00.931757 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:26:00.933752 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:26:00.934752 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:26:01.032968 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.097 seconds
[0m14:26:01.037288 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:26:01.038411 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:26:01.040508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB5FFDD50>]}
[0m14:26:01.042681 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 2.04s]
[0m14:26:01.044754 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:26:01.052765 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:26:01.059963 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m14:26:01.063400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m14:26:01.065049 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m14:26:01.073586 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m14:26:01.076903 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m14:26:01.092501 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m14:26:01.100890 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:26:01.102545 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=  i.university_name
    )
[0m14:26:01.103607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:01.150643 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251102_132601_00162_bzhsk
[0m14:26:01.152656 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:14: mismatched input '('. Expecting: ')', ',', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', 'WINDOW'", query_id=20251102_132601_00162_bzhsk)
[0m14:26:01.154881 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m14:26:01.156491 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m14:26:01.188392 [debug] [Thread-1 (]: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:14: mismatched input '('. Expecting: ')', ',', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', 'WINDOW'", query_id=20251102_132601_00162_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:26:01.190386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6462c50-409a-42d0-b03b-218955a3a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB3C54090>]}
[0m14:26:01.193385 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model testnamespace.fct_regional_education ..... [[31mERROR[0m in 0.13s]
[0m14:26:01.196388 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:26:01.200392 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.fct_regional_education' to be skipped because of status 'error'.  Reason: Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:14: mismatched input '('. Expecting: ')', ',', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', 'WINDOW'", query_id=20251102_132601_00162_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql.
[0m14:26:01.205385 [debug] [MainThread]: On master: COMMIT
[0m14:26:01.206385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:01.206895 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:26:01.207906 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:26:01.208905 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m14:26:01.209905 [info ] [MainThread]: 
[0m14:26:01.212076 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m14:26:01.217465 [debug] [MainThread]: Command end result
[0m14:26:01.254025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:26:01.258025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:26:01.266025 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:26:01.267025 [info ] [MainThread]: 
[0m14:26:01.268024 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:26:01.271033 [info ] [MainThread]: 
[0m14:26:01.276027 [error] [MainThread]: [31mFailure in model fct_regional_education (models\marts\fct_regional_education.sql)[0m
[0m14:26:01.277026 [error] [MainThread]:   Database Error in model fct_regional_education (models\marts\fct_regional_education.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:14: mismatched input '('. Expecting: ')', ',', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', 'WINDOW'", query_id=20251102_132601_00162_bzhsk)
  compiled code at target\run\czech_education\models\marts\fct_regional_education.sql
[0m14:26:01.278031 [info ] [MainThread]: 
[0m14:26:01.280040 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\marts\fct_regional_education.sql
[0m14:26:01.281027 [info ] [MainThread]: 
[0m14:26:01.282047 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:26:01.284040 [debug] [MainThread]: Command `dbt run` failed at 14:26:01.284040 after 8.34 seconds
[0m14:26:01.285024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAE0666D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAE066A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB41507D0>]}
[0m14:26:01.286026 [debug] [MainThread]: Flushing usage events
[0m14:26:02.515066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:08.376841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA3606C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA3645990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA3606590>]}


============================== 14:27:08.382879 | 213a54a0-d3b3-4848-b348-3b57f56d5a8b ==============================
[0m14:27:08.382879 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:27:08.384839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:27:09.225344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA3B3A2D0>]}
[0m14:27:09.412315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA02EEC90>]}
[0m14:27:09.414315 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:27:09.866219 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:27:10.210324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:10.212284 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\marts\fct_regional_education.sql
[0m14:27:10.660576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA4DE2790>]}
[0m14:27:10.791166 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:27:10.796166 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:27:10.823164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA4E51ED0>]}
[0m14:27:10.824165 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:27:10.826167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA3C0B790>]}
[0m14:27:10.832172 [info ] [MainThread]: 
[0m14:27:10.833167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:10.837198 [info ] [MainThread]: 
[0m14:27:10.840168 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:27:10.849164 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:27:11.280544 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:27:11.281545 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:27:11.282544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:11.283573 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:27:11.285356 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA508DA90>]}
[0m14:27:11.442243 [debug] [ThreadPool]: SQL status: SUCCESS in 0.159 seconds
[0m14:27:11.445696 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:27:11.450753 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:27:11.489527 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:27:11.491538 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:27:11.493534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:11.711114 [debug] [ThreadPool]: SQL status: SUCCESS in 0.218 seconds
[0m14:27:11.715108 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:27:11.717109 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:27:11.721108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA4E2B210>]}
[0m14:27:11.722109 [debug] [MainThread]: On master: COMMIT
[0m14:27:11.729625 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:27:11.730626 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:27:11.734639 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:27:11.736624 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:27:11.746628 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:27:11.748628 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:27:11.840181 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:27:11.844179 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:27:11.844179 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:27:11.845192 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:12.534708 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.689 seconds
[0m14:27:12.553505 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:27:12.559687 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:27:12.699820 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.138 seconds
[0m14:27:12.713232 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:27:12.714822 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m14:27:12.834843 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.118 seconds
[0m14:27:12.851839 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:27:12.859836 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:27:12.861839 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:27:12.944670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.082 seconds
[0m14:27:13.013836 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:27:13.014835 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:27:13.019830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA4E2B590>]}
[0m14:27:13.025835 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.28s]
[0m14:27:13.028837 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:27:13.030838 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:27:13.035843 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:27:13.042840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:27:13.045842 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:27:13.052831 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:27:13.060607 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:27:13.068762 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:27:13.073779 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:27:13.076770 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:27:13.077773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:14.119201 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 1.041 seconds
[0m14:27:14.139938 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:27:14.143007 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:27:14.332988 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.188 seconds
[0m14:27:14.347984 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:27:14.350517 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m14:27:14.529238 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.176 seconds
[0m14:27:14.544238 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:27:14.548236 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:27:14.551237 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:27:14.666823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.114 seconds
[0m14:27:14.672008 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:27:14.674439 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:27:14.676389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA3BDBA50>]}
[0m14:27:14.678386 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 1.63s]
[0m14:27:14.683431 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:27:14.691394 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:27:14.693386 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m14:27:14.697413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m14:27:14.700399 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m14:27:14.708386 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m14:27:14.712409 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m14:27:14.718738 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m14:27:14.731737 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:27:14.734739 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m14:27:14.738747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:15.808626 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 1.070 seconds
[0m14:27:15.818282 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:27:15.820473 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m14:27:15.979233 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.155 seconds
[0m14:27:15.988242 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:27:15.990245 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m14:27:16.154048 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.162 seconds
[0m14:27:16.168965 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m14:27:16.179077 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:27:16.181436 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m14:27:16.267528 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.084 seconds
[0m14:27:16.276915 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m14:27:16.277913 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m14:27:16.279914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213a54a0-d3b3-4848-b348-3b57f56d5a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA36455D0>]}
[0m14:27:16.282908 [info ] [Thread-1 (]: 3 of 3 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 1.58s]
[0m14:27:16.286911 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:27:16.297908 [debug] [MainThread]: On master: COMMIT
[0m14:27:16.299612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:16.300689 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:27:16.301743 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:27:16.304121 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m14:27:16.309348 [info ] [MainThread]: 
[0m14:27:16.312128 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.47 seconds (5.47s).
[0m14:27:16.319053 [debug] [MainThread]: Command end result
[0m14:27:16.392744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:27:16.398251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:27:16.409249 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:27:16.410250 [info ] [MainThread]: 
[0m14:27:16.412257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:16.416258 [info ] [MainThread]: 
[0m14:27:16.420257 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:27:16.423250 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:16.423250 after 8.21 seconds
[0m14:27:16.424279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA36A7F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA36A6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9CE8BC10>]}
[0m14:27:16.425251 [debug] [MainThread]: Flushing usage events
[0m14:27:17.562378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:15.556792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F8C36A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F871C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F8C36A90>]}


============================== 15:15:15.564268 | 036fe0cb-ac01-4bd9-bd0e-0120723e3269 ==============================
[0m15:15:15.564268 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:15:15.566234 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m15:15:16.705418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F9101490>]}
[0m15:15:16.814986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F591E210>]}
[0m15:15:16.815987 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:15:17.217733 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:15:17.568433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:17.569432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:17.612797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FA333CD0>]}
[0m15:15:17.693770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:15:17.698770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:15:17.726236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FA3B5350>]}
[0m15:15:17.728239 [info ] [MainThread]: Found 3 models, 455 macros
[0m15:15:17.730243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FA3BFF50>]}
[0m15:15:17.733806 [info ] [MainThread]: 
[0m15:15:17.735811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:17.739808 [info ] [MainThread]: 
[0m15:15:17.740802 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:15:17.752807 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:15:18.180117 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:15:18.181088 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:15:18.181088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:18.182083 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:15:18.183084 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F923A0D0>]}
[0m15:15:21.562065 [debug] [ThreadPool]: SQL status: SUCCESS in 3.381 seconds
[0m15:15:21.564064 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:15:21.569577 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m15:15:21.598799 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m15:15:21.599799 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m15:15:21.600800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:22.664317 [debug] [ThreadPool]: SQL status: SUCCESS in 1.063 seconds
[0m15:15:22.666650 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m15:15:22.667776 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m15:15:22.673601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F8596BD0>]}
[0m15:15:22.675607 [debug] [MainThread]: On master: COMMIT
[0m15:15:22.684607 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m15:15:22.685608 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m15:15:22.688612 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m15:15:22.689607 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m15:15:22.698599 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m15:15:22.701600 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m15:15:22.807723 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m15:15:22.812250 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:15:22.813250 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m15:15:22.814252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:25.170426 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 2.355 seconds
[0m15:15:25.190850 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:15:25.191849 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:15:25.371850 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.178 seconds
[0m15:15:25.380313 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:15:25.381313 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m15:15:25.586126 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.204 seconds
[0m15:15:25.601114 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:15:25.608112 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:15:25.610114 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:15:25.677511 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.066 seconds
[0m15:15:25.704535 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m15:15:25.705537 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m15:15:25.710532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FA6D23D0>]}
[0m15:15:25.712531 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 3.02s]
[0m15:15:25.714540 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m15:15:25.715534 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m15:15:25.716533 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m15:15:25.719532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m15:15:25.721539 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m15:15:25.728530 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m15:15:25.729531 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m15:15:25.735111 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m15:15:25.738111 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:15:25.739111 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m15:15:25.740112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:27.863467 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 2.123 seconds
[0m15:15:27.869228 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:15:27.870855 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:15:28.085473 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.214 seconds
[0m15:15:28.091764 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:15:28.092771 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m15:15:28.282583 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.189 seconds
[0m15:15:28.289577 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:15:28.291579 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:15:28.292578 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:15:28.374540 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.080 seconds
[0m15:15:28.380537 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m15:15:28.381537 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m15:15:28.384533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FABFE390>]}
[0m15:15:28.385531 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 2.66s]
[0m15:15:28.388529 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m15:15:28.393530 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m15:15:28.396534 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m15:15:28.398528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m15:15:28.401530 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m15:15:28.416530 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m15:15:28.419530 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m15:15:28.432528 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m15:15:28.440528 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:15:28.442528 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m15:15:28.443529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:30.029860 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 1.586 seconds
[0m15:15:30.039258 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:15:30.041260 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:15:30.195384 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.152 seconds
[0m15:15:30.207869 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:15:30.208872 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m15:15:30.333931 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.123 seconds
[0m15:15:30.413928 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:15:30.415930 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:15:30.416934 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:15:30.519195 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.101 seconds
[0m15:15:30.524845 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m15:15:30.525845 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m15:15:30.527847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036fe0cb-ac01-4bd9-bd0e-0120723e3269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FACB71D0>]}
[0m15:15:30.529845 [info ] [Thread-1 (]: 3 of 3 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 2.13s]
[0m15:15:30.531853 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m15:15:30.535850 [debug] [MainThread]: On master: COMMIT
[0m15:15:30.538866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:30.541849 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:15:30.542849 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m15:15:30.543846 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m15:15:30.545384 [info ] [MainThread]: 
[0m15:15:30.547544 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.80 seconds (12.80s).
[0m15:15:30.551533 [debug] [MainThread]: Command end result
[0m15:15:30.606394 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:15:30.611391 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:15:30.628392 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m15:15:30.630395 [info ] [MainThread]: 
[0m15:15:30.632403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:30.636400 [info ] [MainThread]: 
[0m15:15:30.644397 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:15:30.651396 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:30.650392 after 15.28 seconds
[0m15:15:30.655409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F24EBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F24658D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6F2465A10>]}
[0m15:15:30.658393 [debug] [MainThread]: Flushing usage events
[0m15:15:31.882773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:08.158423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8DD56C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8DD9AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8DD99AD0>]}


============================== 14:49:08.169427 | 4df18279-745c-4a1a-9431-a5ca50712d74 ==============================
[0m14:49:08.169427 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:49:08.174428 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:49:09.903178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8E26B190>]}
[0m14:49:10.110716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8AA2EE90>]}
[0m14:49:10.111711 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m14:49:10.767304 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:49:11.501992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:11.503992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:11.572991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8E2BF4D0>]}
[0m14:49:11.721067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:49:11.727246 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:49:11.756150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8F4C5550>]}
[0m14:49:11.757210 [info ] [MainThread]: Found 3 models, 455 macros
[0m14:49:11.759081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8F4DBE50>]}
[0m14:49:11.763069 [info ] [MainThread]: 
[0m14:49:11.765071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:11.769071 [info ] [MainThread]: 
[0m14:49:11.770092 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:49:11.783073 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:49:12.428087 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:49:12.430085 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:49:12.432083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:12.433087 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:49:12.435092 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8F553550>]}
[0m14:49:17.995973 [debug] [ThreadPool]: SQL status: SUCCESS in 5.564 seconds
[0m14:49:18.000979 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:49:18.007979 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m14:49:18.057662 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m14:49:18.059662 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m14:49:18.061670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:19.723685 [debug] [ThreadPool]: SQL status: SUCCESS in 1.662 seconds
[0m14:49:19.729192 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m14:49:19.731198 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m14:49:19.738685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8DD84B10>]}
[0m14:49:19.740534 [debug] [MainThread]: On master: COMMIT
[0m14:49:19.754551 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m14:49:19.757502 [info ] [Thread-1 (]: 1 of 3 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m14:49:19.762801 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.stg_graduates'
[0m14:49:19.764817 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m14:49:19.778887 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m14:49:19.783159 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m14:49:20.035249 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m14:49:20.045470 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:49:20.047465 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name 
FROM iceberg.testnamespace.graduatesview
    )
[0m14:49:20.049590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:49:23.428496 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 3.379 seconds
[0m14:49:23.447421 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:49:23.448547 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:49:23.747979 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.297 seconds
[0m14:49:23.757021 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:49:23.758018 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m14:49:23.933073 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.174 seconds
[0m14:49:23.955027 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:49:23.961026 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m14:49:23.963028 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m14:49:24.236987 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.272 seconds
[0m14:49:24.290196 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m14:49:24.292610 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m14:49:24.299319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8E262310>]}
[0m14:49:24.300836 [info ] [Thread-1 (]: 1 of 3 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 4.53s]
[0m14:49:24.303838 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m14:49:24.305852 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m14:49:24.310848 [info ] [Thread-1 (]: 2 of 3 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m14:49:24.313836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m14:49:24.314839 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m14:49:24.323974 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m14:49:24.327250 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m14:49:24.342841 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m14:49:24.353839 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:49:24.356841 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m14:49:24.359272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:28.814347 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 4.455 seconds
[0m14:49:28.824109 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:49:28.825110 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:49:29.135255 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.308 seconds
[0m14:49:29.151548 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:49:29.153537 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m14:49:29.364749 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.208 seconds
[0m14:49:29.375098 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:49:29.377867 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m14:49:29.378851 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m14:49:29.503196 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.123 seconds
[0m14:49:29.510516 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m14:49:29.512204 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m14:49:29.514202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8FDA6E10>]}
[0m14:49:29.518195 [info ] [Thread-1 (]: 2 of 3 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 5.20s]
[0m14:49:29.521195 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m14:49:29.524443 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m14:49:29.527114 [info ] [Thread-1 (]: 3 of 3 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m14:49:29.529114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.fct_regional_education)
[0m14:49:29.532117 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m14:49:29.545084 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m14:49:29.549085 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m14:49:29.557083 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m14:49:29.566083 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:49:29.569084 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m14:49:29.571088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:32.939337 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 3.368 seconds
[0m14:49:32.955692 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:49:32.958265 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m14:49:33.206366 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.245 seconds
[0m14:49:33.229208 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:49:33.231725 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m14:49:33.435034 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.201 seconds
[0m14:49:33.589761 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m14:49:33.596287 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m14:49:33.599291 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m14:49:33.733341 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.131 seconds
[0m14:49:33.740781 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m14:49:33.742854 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m14:49:33.745200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df18279-745c-4a1a-9431-a5ca50712d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8FDEDE50>]}
[0m14:49:33.748410 [info ] [Thread-1 (]: 3 of 3 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 4.22s]
[0m14:49:33.753677 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m14:49:33.759233 [debug] [MainThread]: On master: COMMIT
[0m14:49:33.762234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:33.764221 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m14:49:33.766219 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m14:49:33.768220 [debug] [MainThread]: Connection 'model.czech_education.fct_regional_education' was properly closed.
[0m14:49:33.771231 [info ] [MainThread]: 
[0m14:49:33.773990 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 22.00 seconds (22.00s).
[0m14:49:33.781040 [debug] [MainThread]: Command end result
[0m14:49:33.899512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m14:49:33.907502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m14:49:33.928004 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m14:49:33.930007 [info ] [MainThread]: 
[0m14:49:33.933011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:33.943747 [info ] [MainThread]: 
[0m14:49:33.946754 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:49:33.952753 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:33.951750 after 26.09 seconds
[0m14:49:33.956749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8DDF3F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF8760BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF875858D0>]}
[0m14:49:33.959622 [debug] [MainThread]: Flushing usage events
[0m14:49:35.464663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:39.595814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1B696CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1B703710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1B703810>]}


============================== 15:28:39.606828 | a23ca36c-4757-4872-9bb6-ad959e5b862e ==============================
[0m15:28:39.606828 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:28:39.609815 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m15:28:41.923155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a23ca36c-4757-4872-9bb6-ad959e5b862e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1BBC9E90>]}
[0m15:28:42.057048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a23ca36c-4757-4872-9bb6-ad959e5b862e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B18381810>]}
[0m15:28:42.066061 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:28:42.516077 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:28:43.161584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m15:28:43.161584 [debug] [MainThread]: Partial parsing: added file: czech_education://models\dimensions\dimareascd.sql
[0m15:28:43.164816 [debug] [MainThread]: Partial parsing: added file: czech_education://models\snapshots\area_scd.sql
[0m15:28:43.165324 [debug] [MainThread]: Partial parsing: added file: czech_education://models\semantic.yml
[0m15:28:43.166812 [debug] [MainThread]: Partial parsing: added file: czech_education://models\dimensions\dimarea.sql
[0m15:28:43.167819 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\staging\stg_graduates.sql
[0m15:28:43.605782 [error] [MainThread]: Encountered an error:
Compilation Error in model area_scd (models\snapshots\area_scd.sql)
  Encountered unknown tag 'snapshot'.
    line 2
      {% snapshot area_scd %}
[0m15:28:43.608782 [debug] [MainThread]: Command `dbt run` failed at 15:28:43.607784 after 4.34 seconds
[0m15:28:43.609782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1B737BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1B69C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1B284490>]}
[0m15:28:43.609782 [debug] [MainThread]: Flushing usage events
[0m15:28:45.026572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:08.835018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8E9676510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8E96C4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8E96BDC90>]}


============================== 15:31:08.844358 | 5e06be3e-3835-44f4-b640-8257271d68d5 ==============================
[0m15:31:08.844358 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:31:08.846762 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:31:10.221130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e06be3e-3835-44f4-b640-8257271d68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8E9BD7690>]}
[0m15:31:10.339341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e06be3e-3835-44f4-b640-8257271d68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8E6361D90>]}
[0m15:31:10.340341 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:31:10.812915 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:31:11.179902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m15:31:11.179902 [debug] [MainThread]: Partial parsing: added file: czech_education://models\semantic.yml
[0m15:31:11.182268 [debug] [MainThread]: Partial parsing: added file: czech_education://snapshots\area_scd.sql
[0m15:31:11.182790 [debug] [MainThread]: Partial parsing: added file: czech_education://models\dimensions\dimarea.sql
[0m15:31:11.184381 [debug] [MainThread]: Partial parsing: added file: czech_education://models\dimensions\dimareascd.sql
[0m15:31:11.185382 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\staging\stg_graduates.sql
[0m15:31:12.305915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e06be3e-3835-44f4-b640-8257271d68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8EADBAF90>]}
[0m15:31:12.454736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:31:12.459734 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m15:31:12.461737 [debug] [MainThread]: Command `dbt run` failed at 15:31:12.461737 after 3.81 seconds
[0m15:31:12.463734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8E2E966D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8E9B83D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8E9B81F50>]}
[0m15:31:12.464735 [debug] [MainThread]: Flushing usage events
[0m15:31:13.645759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:22.769893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A7EC6D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A7AB4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A79AEED0>]}


============================== 15:32:22.775927 | 13ef08a3-7618-4b10-a481-f4bd95be3aff ==============================
[0m15:32:22.775927 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:32:22.777905 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:32:23.658017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13ef08a3-7618-4b10-a481-f4bd95be3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A7F33B50>]}
[0m15:32:23.838206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13ef08a3-7618-4b10-a481-f4bd95be3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A4BAD3D0>]}
[0m15:32:23.839207 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:32:24.237587 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:32:24.765457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:32:24.767411 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\semantic.yml
[0m15:32:25.047090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13ef08a3-7618-4b10-a481-f4bd95be3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A6C51A10>]}
[0m15:32:25.200825 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:32:25.206385 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m15:32:25.209505 [debug] [MainThread]: Command `dbt run` failed at 15:32:25.208485 after 2.62 seconds
[0m15:32:25.210557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A7ECC410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A7AB4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A16C66D0>]}
[0m15:32:25.211495 [debug] [MainThread]: Flushing usage events
[0m15:32:26.881549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:11.360515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40CBD6E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40CC43A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40CC1A290>]}


============================== 15:34:11.369510 | f374b8c6-0c85-4451-aa44-16f55d8bc671 ==============================
[0m15:34:11.369510 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:34:11.371637 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:34:12.753064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f374b8c6-0c85-4451-aa44-16f55d8bc671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40C7C4290>]}
[0m15:34:12.889280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f374b8c6-0c85-4451-aa44-16f55d8bc671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4098BE3D0>]}
[0m15:34:12.890358 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:34:13.345670 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:34:13.882521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:34:13.884526 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\semantic.yml
[0m15:34:14.300878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f374b8c6-0c85-4451-aa44-16f55d8bc671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40E3168D0>]}
[0m15:34:14.465734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:34:14.470739 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m15:34:14.474732 [debug] [MainThread]: Command `dbt run` failed at 15:34:14.473746 after 3.29 seconds
[0m15:34:14.475737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40CC77FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40CBDC510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40C7BBE50>]}
[0m15:34:14.477172 [debug] [MainThread]: Flushing usage events
[0m15:34:15.603053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:36.836590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3C7569D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3C756810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3C756910>]}


============================== 15:37:36.842716 | 111b5d16-2eb0-479f-81c7-d020af55e1f7 ==============================
[0m15:37:36.842716 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:37:36.846779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:37:38.105853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '111b5d16-2eb0-479f-81c7-d020af55e1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3CC14050>]}
[0m15:37:38.223364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '111b5d16-2eb0-479f-81c7-d020af55e1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3942F1D0>]}
[0m15:37:38.224718 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:37:38.656777 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:37:39.201126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:39.202539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:39.298258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '111b5d16-2eb0-479f-81c7-d020af55e1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3E0AB9D0>]}
[0m15:37:39.470786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:37:39.478171 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m15:37:39.482018 [debug] [MainThread]: Command `dbt run` failed at 15:37:39.481091 after 2.78 seconds
[0m15:37:39.483019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3C7F7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE360666D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3C74B9D0>]}
[0m15:37:39.484269 [debug] [MainThread]: Flushing usage events
[0m15:37:40.753019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:35.503111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5B9F6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5BA634D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5BA37010>]}


============================== 15:40:35.512864 | 99f71e40-594f-46bc-a113-4c99437f3100 ==============================
[0m15:40:35.512864 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:40:35.515092 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt run', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:40:36.925418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99f71e40-594f-46bc-a113-4c99437f3100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5BF57490>]}
[0m15:40:37.082545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99f71e40-594f-46bc-a113-4c99437f3100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB586CD490>]}
[0m15:40:37.083543 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:40:37.567321 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:40:38.084978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:40:38.085976 [debug] [MainThread]: Partial parsing: added file: czech_education://models\spine.yaml
[0m15:40:38.208137 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'all_days' in the 'models' section of file 'models\spine.yaml'
[0m15:40:38.408316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99f71e40-594f-46bc-a113-4c99437f3100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5BF5F090>]}
[0m15:40:38.598496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:40:38.616798 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m15:40:38.620798 [debug] [MainThread]: Command `dbt run` failed at 15:40:38.619836 after 3.27 seconds
[0m15:40:38.621799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5B9FC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5BA97DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5BA97F90>]}
[0m15:40:38.622799 [debug] [MainThread]: Flushing usage events
[0m15:40:39.802439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:12.262799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B45E6ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B41C44D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B4653A10>]}


============================== 15:41:12.269058 | e92fca35-2494-4669-96a6-c34f681b70be ==============================
[0m15:41:12.269058 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:41:12.270566 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m15:41:13.348316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e92fca35-2494-4669-96a6-c34f681b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B4625290>]}
[0m15:41:13.457961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e92fca35-2494-4669-96a6-c34f681b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B12C6710>]}
[0m15:41:13.458963 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:41:13.931403 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:41:14.339881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:14.339881 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\semantic.yml
[0m15:41:14.713829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e92fca35-2494-4669-96a6-c34f681b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B5D2A1D0>]}
[0m15:41:14.823069 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:41:14.827033 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m15:41:14.854826 [debug] [MainThread]: Command `dbt run` failed at 15:41:14.853978 after 2.74 seconds
[0m15:41:14.857247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B45EC390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B4683ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B4683F90>]}
[0m15:41:14.858880 [debug] [MainThread]: Flushing usage events
[0m15:41:16.540072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:30.396680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A037936ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0379A3D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0379A3410>]}


============================== 15:42:30.403270 | c3742c66-882a-4e3a-b198-40b159f844fa ==============================
[0m15:42:30.403270 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:42:30.404217 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m15:42:31.248906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3742c66-882a-4e3a-b198-40b159f844fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A037D0A850>]}
[0m15:42:31.392954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3742c66-882a-4e3a-b198-40b159f844fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03460EC50>]}
[0m15:42:31.393957 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:42:31.888853 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:42:32.323417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:42:32.324582 [debug] [MainThread]: Partial parsing: added file: czech_education://models\spine.sql
[0m15:42:32.952382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3742c66-882a-4e3a-b198-40b159f844fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A039378A50>]}
[0m15:42:33.092890 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:42:33.099305 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m15:42:33.105116 [debug] [MainThread]: Command `dbt run` failed at 15:42:33.104109 after 2.86 seconds
[0m15:42:33.106116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03793C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0379D7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0379D7F90>]}
[0m15:42:33.107781 [debug] [MainThread]: Flushing usage events
[0m15:42:34.172747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:07.474019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679D2D6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679D343D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679D317490>]}


============================== 15:45:07.487186 | af513113-8b19-4f63-b1eb-ffb8cd666b30 ==============================
[0m15:45:07.487186 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:45:07.490734 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:45:09.018414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679D316190>]}
[0m15:45:09.145233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799FBE550>]}
[0m15:45:09.146234 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:45:09.972388 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:45:10.467733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:10.469834 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\spine.yaml
[0m15:45:10.839572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679EC2E650>]}
[0m15:45:11.046347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:45:11.060335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:45:11.093768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679EA14E50>]}
[0m15:45:11.094582 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m15:45:11.096588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679ED8D010>]}
[0m15:45:11.100772 [info ] [MainThread]: 
[0m15:45:11.102664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:11.106131 [info ] [MainThread]: 
[0m15:45:11.107658 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:45:11.118788 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:45:12.066086 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:45:12.067083 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:45:12.068304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:12.069519 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:45:12.073174 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679EE66150>]}
[0m15:45:16.862788 [debug] [ThreadPool]: SQL status: SUCCESS in 4.794 seconds
[0m15:45:16.865747 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:45:16.870874 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m15:45:16.901087 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m15:45:16.902169 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m15:45:16.902806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:18.166439 [debug] [ThreadPool]: SQL status: SUCCESS in 1.263 seconds
[0m15:45:18.170943 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m15:45:18.172124 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m15:45:18.174591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_testnamespace, now list_iceberg_snapshots)
[0m15:45:18.195089 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m15:45:18.196900 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m15:45:18.198900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:18.989628 [debug] [ThreadPool]: SQL status: SUCCESS in 0.791 seconds
[0m15:45:18.993126 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m15:45:18.994312 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m15:45:18.997206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679EFCCF50>]}
[0m15:45:18.998314 [debug] [MainThread]: On master: COMMIT
[0m15:45:19.008308 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m15:45:19.009314 [info ] [Thread-1 (]: 1 of 6 START sql table model testnamespace.spine ............................... [RUN]
[0m15:45:19.012311 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m15:45:19.014309 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m15:45:19.060738 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:45:19.060738 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */


        select ((to_milliseconds((CAST(CAST(to_date('01/01/2030','mm/dd/yyyy') AS TIMESTAMP) AS DATE) - CAST(CAST(to_date('01/01/2025','mm/dd/yyyy') AS TIMESTAMP) AS DATE)))) / 86400000)
[0m15:45:19.066935 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:21.463326 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.396 seconds
[0m15:45:21.488007 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m15:45:21.491872 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m15:45:21.568634 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.spine"
[0m15:45:21.583601 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:45:21.584605 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

  
    

    create table "iceberg"."testnamespace"."spine"
      
      
    as (
      

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1826
    order by generated_number



    ),

    all_periods as (

        select (
            date_add('day', row_number() over (order by 1) - 1, cast(to_date('01/01/2025','mm/dd/yyyy') as date))
        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
    where date_day <= cast(to_date('01/01/2030','mm/dd/yyyy') as date)

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
where date_day > dateadd(year, -4, current_timestamp()) 
and date_day < dateadd(day, 30, current_timestamp())
    )
[0m15:45:21.832781 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251105_190124_00111_bzhsk
[0m15:45:21.833527 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 146:53: mismatched input '('. Expecting: ')', ',', 'ORDER'", query_id=20251105_190124_00111_bzhsk)
[0m15:45:21.834705 [debug] [Thread-1 (]: On model.czech_education.spine: ROLLBACK
[0m15:45:21.835481 [debug] [Thread-1 (]: On model.czech_education.spine: Close
[0m15:45:21.859536 [debug] [Thread-1 (]: Database Error in model spine (models\spine.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 146:53: mismatched input '('. Expecting: ')', ',', 'ORDER'", query_id=20251105_190124_00111_bzhsk)
  compiled code at target\run\czech_education\models\spine.sql
[0m15:45:21.866532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679ECBD950>]}
[0m15:45:21.868152 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model testnamespace.spine ...................... [[31mERROR[0m in 2.85s]
[0m15:45:21.871031 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m15:45:21.872872 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m15:45:21.874259 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.spine' to be skipped because of status 'error'.  Reason: Database Error in model spine (models\spine.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 146:53: mismatched input '('. Expecting: ')', ',', 'ORDER'", query_id=20251105_190124_00111_bzhsk)
  compiled code at target\run\czech_education\models\spine.sql.
[0m15:45:21.875883 [info ] [Thread-1 (]: 2 of 6 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m15:45:21.878895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.spine, now model.czech_education.stg_graduates)
[0m15:45:21.879887 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m15:45:21.887915 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m15:45:21.891104 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m15:45:21.898106 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m15:45:21.903339 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:45:21.904496 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name,
    area_name
FROM iceberg.testnamespace.graduatesview
    )
[0m15:45:21.907296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:24.408655 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 2.501 seconds
[0m15:45:24.429517 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:45:24.430648 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:45:24.612833 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.181 seconds
[0m15:45:24.619075 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:45:24.620073 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m15:45:24.833228 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.212 seconds
[0m15:45:24.848270 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:45:24.853486 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:45:24.855015 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:45:24.996418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.139 seconds
[0m15:45:25.036463 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m15:45:25.036463 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m15:45:25.038828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CC61250>]}
[0m15:45:25.040829 [info ] [Thread-1 (]: 2 of 6 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 3.16s]
[0m15:45:25.043743 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m15:45:25.045742 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m15:45:25.047743 [info ] [Thread-1 (]: 3 of 6 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m15:45:25.050759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m15:45:25.052748 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m15:45:25.057498 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m15:45:25.060527 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m15:45:25.068499 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m15:45:25.079902 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:45:25.080503 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m15:45:25.082501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:27.608155 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 2.526 seconds
[0m15:45:27.619667 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:45:27.620666 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:45:28.420673 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.798 seconds
[0m15:45:28.431778 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:45:28.433300 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m15:45:28.760859 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.326 seconds
[0m15:45:28.768590 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:45:28.771345 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:45:28.773344 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:45:28.891577 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.117 seconds
[0m15:45:28.895455 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m15:45:28.896747 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m15:45:28.898069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679D174310>]}
[0m15:45:28.901298 [info ] [Thread-1 (]: 3 of 6 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 3.85s]
[0m15:45:28.902847 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m15:45:28.905660 [debug] [Thread-1 (]: Began running node model.czech_education.dimarea
[0m15:45:28.906664 [info ] [Thread-1 (]: 4 of 6 START sql table model testnamespace.dimarea ............................. [RUN]
[0m15:45:28.908779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.dimarea)
[0m15:45:28.911340 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimarea
[0m15:45:28.918670 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimarea"
[0m15:45:28.923556 [debug] [Thread-1 (]: Began executing node model.czech_education.dimarea
[0m15:45:28.929623 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimarea"
[0m15:45:28.939127 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:45:28.940569 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

  
    

    create table "iceberg"."testnamespace"."dimarea"
      
      
    as (
      


    SELECT 
        area_code,
        area_name
    FROM "iceberg"."testnamespace"."stg_graduates"
    )
[0m15:45:28.941571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:29.873234 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.931 seconds
[0m15:45:29.879494 [debug] [Thread-1 (]: On model.czech_education.dimarea: ROLLBACK
[0m15:45:29.881151 [debug] [Thread-1 (]: On model.czech_education.dimarea: Close
[0m15:45:29.883678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679F026990>]}
[0m15:45:29.885677 [info ] [Thread-1 (]: 4 of 6 OK created sql table model testnamespace.dimarea ........................ [[32mCREATE TABLE (223 rows)[0m in 0.97s]
[0m15:45:29.888270 [debug] [Thread-1 (]: Finished running node model.czech_education.dimarea
[0m15:45:29.890412 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m15:45:29.892427 [info ] [Thread-1 (]: 5 of 6 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m15:45:29.894425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.dimarea, now model.czech_education.fct_regional_education)
[0m15:45:29.896425 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m15:45:29.905423 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m15:45:29.908422 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m15:45:29.915020 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m15:45:29.924969 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:45:29.926515 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m15:45:29.927835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:31.108510 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 1.180 seconds
[0m15:45:31.119218 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:45:31.121226 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:45:31.258548 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.135 seconds
[0m15:45:31.265581 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:45:31.266367 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m15:45:31.435618 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.167 seconds
[0m15:45:31.444247 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:45:31.446254 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:45:31.448259 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:45:31.565715 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.117 seconds
[0m15:45:31.573269 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m15:45:31.575270 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m15:45:31.578278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679F501890>]}
[0m15:45:31.581277 [info ] [Thread-1 (]: 5 of 6 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 1.68s]
[0m15:45:31.585277 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m15:45:31.587270 [debug] [Thread-1 (]: Began running node model.czech_education.dimareascd
[0m15:45:31.591384 [info ] [Thread-1 (]: 6 of 6 START sql table model testnamespace.dimareascd .......................... [RUN]
[0m15:45:31.595424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.fct_regional_education, now model.czech_education.dimareascd)
[0m15:45:31.598392 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimareascd
[0m15:45:31.610817 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimareascd"
[0m15:45:31.617211 [debug] [Thread-1 (]: Began executing node model.czech_education.dimareascd
[0m15:45:31.630851 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimareascd"
[0m15:45:31.637365 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimareascd"
[0m15:45:31.639365 [debug] [Thread-1 (]: On model.czech_education.dimareascd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimareascd"} */

  
    

    create table "iceberg"."testnamespace"."dimareascd"
      
      
    as (
      -- models/dim/dim_product_history.sql
SELECT 
    area_code,
    area_name,
    dbt_valid_from as effective_date,
    dbt_valid_to as expiry_date,
    CASE 
        WHEN dbt_valid_to IS NULL THEN 1 
        ELSE 0 
    END as is_current
FROM "iceberg"."snapshots"."area_scd"
ORDER BY   area_code effective_date
    )
[0m15:45:31.641366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:31.687073 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251105_190134_00125_bzhsk
[0m15:45:31.688254 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 21:22: mismatched input 'effective_date'. Expecting: '%', '(', ')', '*', '+', ',', '-', '->', '.', '/', 'AND', 'ASC', 'AT', 'DESC', 'FETCH', 'LIMIT', 'NULLS', 'OFFSET', 'OR', 'OVER', '[', '||', <predicate>, <string>", query_id=20251105_190134_00125_bzhsk)
[0m15:45:31.690041 [debug] [Thread-1 (]: On model.czech_education.dimareascd: ROLLBACK
[0m15:45:31.690775 [debug] [Thread-1 (]: On model.czech_education.dimareascd: Close
[0m15:45:31.695190 [debug] [Thread-1 (]: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 21:22: mismatched input 'effective_date'. Expecting: '%', '(', ')', '*', '+', ',', '-', '->', '.', '/', 'AND', 'ASC', 'AT', 'DESC', 'FETCH', 'LIMIT', 'NULLS', 'OFFSET', 'OR', 'OVER', '[', '||', <predicate>, <string>", query_id=20251105_190134_00125_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m15:45:31.698100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af513113-8b19-4f63-b1eb-ffb8cd666b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679F0C0F90>]}
[0m15:45:31.700419 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model testnamespace.dimareascd ................. [[31mERROR[0m in 0.10s]
[0m15:45:31.702114 [debug] [Thread-1 (]: Finished running node model.czech_education.dimareascd
[0m15:45:31.705112 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.dimareascd' to be skipped because of status 'error'.  Reason: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 21:22: mismatched input 'effective_date'. Expecting: '%', '(', ')', '*', '+', ',', '-', '->', '.', '/', 'AND', 'ASC', 'AT', 'DESC', 'FETCH', 'LIMIT', 'NULLS', 'OFFSET', 'OR', 'OVER', '[', '||', <predicate>, <string>", query_id=20251105_190134_00125_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql.
[0m15:45:31.708117 [debug] [MainThread]: On master: COMMIT
[0m15:45:31.709147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:31.709719 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:45:31.711239 [debug] [MainThread]: Connection 'list_iceberg_snapshots' was properly closed.
[0m15:45:31.711722 [debug] [MainThread]: Connection 'model.czech_education.dimareascd' was properly closed.
[0m15:45:31.713722 [info ] [MainThread]: 
[0m15:45:31.715456 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 20.61 seconds (20.61s).
[0m15:45:31.720425 [debug] [MainThread]: Command end result
[0m15:45:31.767968 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:45:31.774059 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:45:31.793333 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m15:45:31.794643 [info ] [MainThread]: 
[0m15:45:31.795634 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:45:31.798639 [info ] [MainThread]: 
[0m15:45:31.805513 [error] [MainThread]: [31mFailure in model spine (models\spine.sql)[0m
[0m15:45:31.806958 [error] [MainThread]:   Database Error in model spine (models\spine.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 146:53: mismatched input '('. Expecting: ')', ',', 'ORDER'", query_id=20251105_190124_00111_bzhsk)
  compiled code at target\run\czech_education\models\spine.sql
[0m15:45:31.810622 [info ] [MainThread]: 
[0m15:45:31.812523 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\spine.sql
[0m15:45:31.819520 [info ] [MainThread]: 
[0m15:45:31.822906 [error] [MainThread]: [31mFailure in model dimareascd (models\dimensions\dimareascd.sql)[0m
[0m15:45:31.824898 [error] [MainThread]:   Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 21:22: mismatched input 'effective_date'. Expecting: '%', '(', ')', '*', '+', ',', '-', '->', '.', '/', 'AND', 'ASC', 'AT', 'DESC', 'FETCH', 'LIMIT', 'NULLS', 'OFFSET', 'OR', 'OVER', '[', '||', <predicate>, <string>", query_id=20251105_190134_00125_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m15:45:31.829900 [info ] [MainThread]: 
[0m15:45:31.831995 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\dimensions\dimareascd.sql
[0m15:45:31.834007 [info ] [MainThread]: 
[0m15:45:31.844761 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=6
[0m15:45:31.854758 [debug] [MainThread]: Command `dbt run` failed at 15:45:31.853760 after 24.62 seconds
[0m15:45:31.856378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016796AF66D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016796AF65D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679D6B0F10>]}
[0m15:45:31.857429 [debug] [MainThread]: Flushing usage events
[0m15:45:33.367983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:36.444735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1432D7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B143317210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1433434D0>]}


============================== 15:48:36.452749 | 07d04af0-db06-4e84-944c-ad72556a247c ==============================
[0m15:48:36.452749 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:48:36.454735 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile -select spine', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:48:37.633058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07d04af0-db06-4e84-944c-ad72556a247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14380A4D0>]}
[0m15:48:37.748870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07d04af0-db06-4e84-944c-ad72556a247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13FFB1E50>]}
[0m15:48:37.750117 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:48:38.214690 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:48:38.874086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:38.875087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:38.957472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07d04af0-db06-4e84-944c-ad72556a247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B144B49310>]}
[0m15:48:39.081219 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:48:39.088781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:48:39.113771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07d04af0-db06-4e84-944c-ad72556a247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B144C64C10>]}
[0m15:48:39.114790 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m15:48:39.117811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d04af0-db06-4e84-944c-ad72556a247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14376F110>]}
[0m15:48:39.120777 [warn ] [MainThread]: The selection criterion 'elect' does not match any enabled nodes
[0m15:48:39.127141 [info ] [MainThread]: 
[0m15:48:39.127923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:39.129880 [info ] [MainThread]: 
[0m15:48:39.131016 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:48:39.142882 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_snapshots'
[0m15:48:39.732051 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m15:48:39.732807 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m15:48:39.734348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:39.735955 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:48:39.737613 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '07d04af0-db06-4e84-944c-ad72556a247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B144D6F910>]}
[0m15:48:40.021863 [debug] [ThreadPool]: SQL status: SUCCESS in 0.287 seconds
[0m15:48:40.025413 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m15:48:40.026572 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m15:48:40.028692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_snapshots, now list_iceberg_testnamespace)
[0m15:48:40.040509 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m15:48:40.041511 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m15:48:40.042539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:40.219415 [debug] [ThreadPool]: SQL status: SUCCESS in 0.177 seconds
[0m15:48:40.224324 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m15:48:40.226105 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m15:48:40.231785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d04af0-db06-4e84-944c-ad72556a247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14263F250>]}
[0m15:48:40.241179 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m15:48:40.243182 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m15:48:40.245183 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m15:48:40.303464 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:48:40.304539 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */


        select ((to_milliseconds((CAST(CAST(to_date('01/01/2030','mm/dd/yyyy') AS TIMESTAMP) AS DATE) - CAST(CAST(to_date('01/01/2025','mm/dd/yyyy') AS TIMESTAMP) AS DATE)))) / 86400000)
[0m15:48:40.305466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:40.354725 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.049 seconds
[0m15:48:40.378418 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m15:48:40.379420 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m15:48:40.381418 [debug] [Thread-1 (]: On model.czech_education.spine: ROLLBACK
[0m15:48:40.382417 [debug] [Thread-1 (]: On model.czech_education.spine: Close
[0m15:48:40.384416 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m15:48:40.386418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:40.387415 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m15:48:40.388026 [debug] [MainThread]: Connection 'model.czech_education.spine' was properly closed.
[0m15:48:40.389419 [debug] [MainThread]: Command end result
[0m15:48:40.427185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:48:40.432763 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:48:40.443625 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m15:48:40.444770 [debug] [MainThread]: Excluded node 'spine' from results
[0m15:48:40.446939 [debug] [MainThread]: Command `dbt compile` succeeded at 15:48:40.446939 after 4.30 seconds
[0m15:48:40.448140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B143373CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CB26610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CB25A10>]}
[0m15:48:40.448908 [debug] [MainThread]: Flushing usage events
[0m15:48:41.788582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:03.283252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C8D37150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C89209D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C89208D0>]}


============================== 15:49:03.291252 | 0a0e6cc8-a9bb-41fd-8d3b-66a93fc19ee0 ==============================
[0m15:49:03.291252 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:49:03.292281 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt compile --select spine', 'printer_width': '80', 'write_json': 'True'}
[0m15:49:04.249509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a0e6cc8-a9bb-41fd-8d3b-66a93fc19ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C922DB50>]}
[0m15:49:04.365397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a0e6cc8-a9bb-41fd-8d3b-66a93fc19ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C8E989D0>]}
[0m15:49:04.366533 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:49:04.930272 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:49:05.275247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:05.275247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:05.355062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a0e6cc8-a9bb-41fd-8d3b-66a93fc19ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240CA4CFB50>]}
[0m15:49:05.560376 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:49:05.570388 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:49:05.596826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a0e6cc8-a9bb-41fd-8d3b-66a93fc19ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240CA5A7A10>]}
[0m15:49:05.598662 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m15:49:05.600665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a0e6cc8-a9bb-41fd-8d3b-66a93fc19ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C922F210>]}
[0m15:49:05.605667 [info ] [MainThread]: 
[0m15:49:05.609664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:05.611662 [info ] [MainThread]: 
[0m15:49:05.614664 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:49:05.633669 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m15:49:06.035071 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m15:49:06.036074 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m15:49:06.037075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:06.038075 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:49:06.040038 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '0a0e6cc8-a9bb-41fd-8d3b-66a93fc19ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C92CC410>]}
[0m15:49:06.294782 [debug] [ThreadPool]: SQL status: SUCCESS in 0.258 seconds
[0m15:49:06.298779 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m15:49:06.299778 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m15:49:06.302480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_testnamespace, now list_iceberg_snapshots)
[0m15:49:06.315693 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m15:49:06.317166 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m15:49:06.317166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:06.457145 [debug] [ThreadPool]: SQL status: SUCCESS in 0.139 seconds
[0m15:49:06.460666 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m15:49:06.461861 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m15:49:06.464468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a0e6cc8-a9bb-41fd-8d3b-66a93fc19ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C9123910>]}
[0m15:49:06.470876 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m15:49:06.472873 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m15:49:06.474874 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m15:49:06.540417 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:49:06.542198 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */


        select ((to_milliseconds((CAST(CAST(to_date('01/01/2030','mm/dd/yyyy') AS TIMESTAMP) AS DATE) - CAST(CAST(to_date('01/01/2025','mm/dd/yyyy') AS TIMESTAMP) AS DATE)))) / 86400000)
[0m15:49:06.543198 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:06.610911 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.067 seconds
[0m15:49:06.661976 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m15:49:06.664978 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m15:49:06.666978 [debug] [Thread-1 (]: On model.czech_education.spine: ROLLBACK
[0m15:49:06.668979 [debug] [Thread-1 (]: On model.czech_education.spine: Close
[0m15:49:06.673534 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m15:49:06.675529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:06.677531 [debug] [MainThread]: Connection 'list_iceberg_snapshots' was properly closed.
[0m15:49:06.678528 [debug] [MainThread]: Connection 'model.czech_education.spine' was properly closed.
[0m15:49:06.679526 [debug] [MainThread]: Command end result
[0m15:49:06.732100 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:49:06.737102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:49:06.751532 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m15:49:06.752538 [info ] [MainThread]: Compiled node 'spine' is:


with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1826
    order by generated_number



    ),

    all_periods as (

        select (
            date_add('day', row_number() over (order by 1) - 1, cast(to_date('01/01/2025','mm/dd/yyyy') as date))
        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
    where date_day <= cast(to_date('01/01/2030','mm/dd/yyyy') as date)

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
where date_day > dateadd(year, -4, current_timestamp()) 
and date_day < dateadd(day, 30, current_timestamp())
[0m15:49:06.762307 [debug] [MainThread]: Command `dbt compile` succeeded at 15:49:06.761164 after 3.66 seconds
[0m15:49:06.763262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C8D36AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C2555A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240C2555A10>]}
[0m15:49:06.765160 [debug] [MainThread]: Flushing usage events
[0m15:49:08.003902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:57.925299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED7446CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED74B3C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED748A050>]}


============================== 15:53:57.936461 | 2ecf6416-787f-4f79-8c66-159ef5a614c3 ==============================
[0m15:53:57.936461 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:53:57.939471 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m15:53:59.152870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED78DAB90>]}
[0m15:53:59.288009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED4122550>]}
[0m15:53:59.290014 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:53:59.890423 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:54:00.362008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:00.364008 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\spine.sql
[0m15:54:01.140217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED8E29AD0>]}
[0m15:54:01.378679 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:54:01.398867 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:54:01.487767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED8FFB990>]}
[0m15:54:01.495770 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m15:54:01.499778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED3650290>]}
[0m15:54:01.509756 [info ] [MainThread]: 
[0m15:54:01.515087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:54:01.517834 [info ] [MainThread]: 
[0m15:54:01.520761 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:54:01.539936 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:54:02.148981 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:54:02.150975 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:54:02.152968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:02.154318 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:54:02.157926 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED8FC7590>]}
[0m15:54:02.537540 [debug] [ThreadPool]: SQL status: SUCCESS in 0.384 seconds
[0m15:54:02.540166 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:54:02.544698 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m15:54:02.574805 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m15:54:02.575806 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m15:54:02.577113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:02.846140 [debug] [ThreadPool]: SQL status: SUCCESS in 0.269 seconds
[0m15:54:02.849768 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m15:54:02.850876 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m15:54:02.852876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_testnamespace, now list_iceberg_snapshots)
[0m15:54:02.864981 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m15:54:02.865885 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m15:54:02.866894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:02.993904 [debug] [ThreadPool]: SQL status: SUCCESS in 0.127 seconds
[0m15:54:02.997885 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m15:54:02.999126 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m15:54:03.002196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED46C1350>]}
[0m15:54:03.003960 [debug] [MainThread]: On master: COMMIT
[0m15:54:03.013543 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m15:54:03.015546 [info ] [Thread-1 (]: 1 of 6 START sql table model testnamespace.spine ............................... [RUN]
[0m15:54:03.017548 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m15:54:03.019549 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m15:54:03.028544 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m15:54:03.031157 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m15:54:03.125850 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.spine"
[0m15:54:03.128848 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:54:03.129813 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

  
    

    create table "iceberg"."testnamespace"."spine"
      
      
    as (
      SELECT CURRENT_TIMESTAMP  AS date_day
    )
[0m15:54:03.130881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:54:04.124889 [debug] [Thread-1 (]: SQL status: CREATE TABLE (1 rows) in 0.994 seconds
[0m15:54:04.163700 [debug] [Thread-1 (]: On model.czech_education.spine: ROLLBACK
[0m15:54:04.164878 [debug] [Thread-1 (]: On model.czech_education.spine: Close
[0m15:54:04.169695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED92DCC90>]}
[0m15:54:04.171696 [info ] [Thread-1 (]: 1 of 6 OK created sql table model testnamespace.spine .......................... [[32mCREATE TABLE (1 rows)[0m in 1.15s]
[0m15:54:04.173809 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m15:54:04.175696 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m15:54:04.177699 [info ] [Thread-1 (]: 2 of 6 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m15:54:04.183365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.spine, now model.czech_education.stg_graduates)
[0m15:54:04.184387 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m15:54:04.189980 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m15:54:04.194384 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m15:54:04.204935 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m15:54:04.209995 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:54:04.213072 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name,
    area_name
FROM iceberg.testnamespace.graduatesview
    )
[0m15:54:04.216648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:05.152929 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.936 seconds
[0m15:54:05.169877 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:54:05.170694 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:54:05.314389 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.142 seconds
[0m15:54:05.324126 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:54:05.324979 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m15:54:05.480130 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.153 seconds
[0m15:54:05.502506 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:54:05.510506 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:54:05.512509 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:54:05.603443 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.088 seconds
[0m15:54:05.621190 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m15:54:05.624192 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m15:54:05.628192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED9334910>]}
[0m15:54:05.632196 [info ] [Thread-1 (]: 2 of 6 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.45s]
[0m15:54:05.636196 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m15:54:05.638460 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m15:54:05.641454 [info ] [Thread-1 (]: 3 of 6 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m15:54:05.645464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m15:54:05.648615 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m15:54:05.658005 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m15:54:05.663001 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m15:54:05.684049 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m15:54:05.691099 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:54:05.694099 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m15:54:05.696099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:07.390919 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 1.695 seconds
[0m15:54:07.399481 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:54:07.401555 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:54:07.517841 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.115 seconds
[0m15:54:07.524685 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:54:07.526415 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m15:54:07.679735 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.150 seconds
[0m15:54:07.687357 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:54:07.689359 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:54:07.690358 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:54:07.809090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.117 seconds
[0m15:54:07.813365 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m15:54:07.815267 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m15:54:07.817270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED92EE950>]}
[0m15:54:07.819349 [info ] [Thread-1 (]: 3 of 6 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 2.17s]
[0m15:54:07.821274 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m15:54:07.823288 [debug] [Thread-1 (]: Began running node model.czech_education.dimarea
[0m15:54:07.826271 [info ] [Thread-1 (]: 4 of 6 START sql table model testnamespace.dimarea ............................. [RUN]
[0m15:54:07.831267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.dimarea)
[0m15:54:07.832549 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimarea
[0m15:54:07.840268 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimarea"
[0m15:54:07.844263 [debug] [Thread-1 (]: Began executing node model.czech_education.dimarea
[0m15:54:07.854522 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimarea"
[0m15:54:07.859534 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:54:07.860643 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

  
    

    create table "iceberg"."testnamespace"."dimarea__dbt_tmp"
      
      
    as (
      


    SELECT 
        area_code,
        area_name
    FROM "iceberg"."testnamespace"."stg_graduates"
    )
[0m15:54:07.862522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:08.477367 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.615 seconds
[0m15:54:08.488052 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:54:08.489170 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea" rename to "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m15:54:08.637539 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.147 seconds
[0m15:54:08.643395 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:54:08.644391 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea__dbt_tmp" rename to "iceberg"."testnamespace"."dimarea"
[0m15:54:08.905682 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.259 seconds
[0m15:54:08.919768 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m15:54:08.923679 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:54:08.925590 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

    drop table if exists "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m15:54:09.051147 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.123 seconds
[0m15:54:09.059210 [debug] [Thread-1 (]: On model.czech_education.dimarea: ROLLBACK
[0m15:54:09.061259 [debug] [Thread-1 (]: On model.czech_education.dimarea: Close
[0m15:54:09.064258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED9231B10>]}
[0m15:54:09.067832 [info ] [Thread-1 (]: 4 of 6 OK created sql table model testnamespace.dimarea ........................ [[32mCREATE TABLE (223 rows)[0m in 1.23s]
[0m15:54:09.071850 [debug] [Thread-1 (]: Finished running node model.czech_education.dimarea
[0m15:54:09.075280 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m15:54:09.079278 [info ] [Thread-1 (]: 5 of 6 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m15:54:09.082553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.dimarea, now model.czech_education.fct_regional_education)
[0m15:54:09.084553 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m15:54:09.100004 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m15:54:09.103002 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m15:54:09.122796 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m15:54:09.140801 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:54:09.142792 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m15:54:09.145791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:10.243423 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 1.098 seconds
[0m15:54:10.251451 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:54:10.252524 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:54:10.395866 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.142 seconds
[0m15:54:10.406627 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:54:10.408629 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m15:54:10.520160 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.109 seconds
[0m15:54:10.528167 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:54:10.531167 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:54:10.533171 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:54:10.642338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.107 seconds
[0m15:54:10.647080 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m15:54:10.648247 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m15:54:10.650792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED936A710>]}
[0m15:54:10.653790 [info ] [Thread-1 (]: 5 of 6 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 1.57s]
[0m15:54:10.659186 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m15:54:10.661785 [debug] [Thread-1 (]: Began running node model.czech_education.dimareascd
[0m15:54:10.665163 [info ] [Thread-1 (]: 6 of 6 START sql table model testnamespace.dimareascd .......................... [RUN]
[0m15:54:10.667250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.fct_regional_education, now model.czech_education.dimareascd)
[0m15:54:10.668244 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimareascd
[0m15:54:10.678348 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimareascd"
[0m15:54:10.680400 [debug] [Thread-1 (]: Began executing node model.czech_education.dimareascd
[0m15:54:10.691720 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimareascd"
[0m15:54:10.702048 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimareascd"
[0m15:54:10.703378 [debug] [Thread-1 (]: On model.czech_education.dimareascd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimareascd"} */

  
    

    create table "iceberg"."testnamespace"."dimareascd"
      
      
    as (
      -- models/dim/dim_product_history.sql
SELECT 
    area_code,
    area_name,
    dbt_valid_from as effective_date,
    dbt_valid_to as expiry_date,
    CASE 
        WHEN dbt_valid_to IS NULL THEN 1 
        ELSE 0 
    END as is_current
FROM "iceberg"."snapshots"."area_scd"
ORDER BY   area_code effective_date
    )
[0m15:54:10.705488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:10.750017 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251105_191014_00152_bzhsk
[0m15:54:10.752076 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 21:22: mismatched input 'effective_date'. Expecting: '%', '(', ')', '*', '+', ',', '-', '->', '.', '/', 'AND', 'ASC', 'AT', 'DESC', 'FETCH', 'LIMIT', 'NULLS', 'OFFSET', 'OR', 'OVER', '[', '||', <predicate>, <string>", query_id=20251105_191014_00152_bzhsk)
[0m15:54:10.753870 [debug] [Thread-1 (]: On model.czech_education.dimareascd: ROLLBACK
[0m15:54:10.755671 [debug] [Thread-1 (]: On model.czech_education.dimareascd: Close
[0m15:54:10.779975 [debug] [Thread-1 (]: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 21:22: mismatched input 'effective_date'. Expecting: '%', '(', ')', '*', '+', ',', '-', '->', '.', '/', 'AND', 'ASC', 'AT', 'DESC', 'FETCH', 'LIMIT', 'NULLS', 'OFFSET', 'OR', 'OVER', '[', '||', <predicate>, <string>", query_id=20251105_191014_00152_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m15:54:10.781789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ecf6416-787f-4f79-8c66-159ef5a614c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED9390090>]}
[0m15:54:10.783782 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model testnamespace.dimareascd ................. [[31mERROR[0m in 0.12s]
[0m15:54:10.786782 [debug] [Thread-1 (]: Finished running node model.czech_education.dimareascd
[0m15:54:10.788782 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.dimareascd' to be skipped because of status 'error'.  Reason: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 21:22: mismatched input 'effective_date'. Expecting: '%', '(', ')', '*', '+', ',', '-', '->', '.', '/', 'AND', 'ASC', 'AT', 'DESC', 'FETCH', 'LIMIT', 'NULLS', 'OFFSET', 'OR', 'OVER', '[', '||', <predicate>, <string>", query_id=20251105_191014_00152_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql.
[0m15:54:10.792783 [debug] [MainThread]: On master: COMMIT
[0m15:54:10.794906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:10.795784 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:54:10.797190 [debug] [MainThread]: Connection 'list_iceberg_snapshots' was properly closed.
[0m15:54:10.797779 [debug] [MainThread]: Connection 'model.czech_education.dimareascd' was properly closed.
[0m15:54:10.799089 [info ] [MainThread]: 
[0m15:54:10.801079 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m15:54:10.807811 [debug] [MainThread]: Command end result
[0m15:54:10.888669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:54:10.897159 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:54:10.914746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m15:54:10.915746 [info ] [MainThread]: 
[0m15:54:10.917757 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:54:10.923242 [info ] [MainThread]: 
[0m15:54:10.929033 [error] [MainThread]: [31mFailure in model dimareascd (models\dimensions\dimareascd.sql)[0m
[0m15:54:10.931727 [error] [MainThread]:   Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 21:22: mismatched input 'effective_date'. Expecting: '%', '(', ')', '*', '+', ',', '-', '->', '.', '/', 'AND', 'ASC', 'AT', 'DESC', 'FETCH', 'LIMIT', 'NULLS', 'OFFSET', 'OR', 'OVER', '[', '||', <predicate>, <string>", query_id=20251105_191014_00152_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m15:54:10.933734 [info ] [MainThread]: 
[0m15:54:10.939044 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\dimensions\dimareascd.sql
[0m15:54:10.943354 [info ] [MainThread]: 
[0m15:54:10.948320 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m15:54:10.952096 [debug] [MainThread]: Command `dbt run` failed at 15:54:10.952096 after 13.20 seconds
[0m15:54:10.958374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED74E7F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED74E7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ED63CA890>]}
[0m15:54:10.961836 [debug] [MainThread]: Flushing usage events
[0m15:54:12.437250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:27.725446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D22236C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D21D0C390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D22274AD0>]}


============================== 15:55:27.733669 | 9e14c18f-e369-4ab2-a273-3050eb522158 ==============================
[0m15:55:27.733669 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:55:27.735456 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:55:29.035019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D22752D50>]}
[0m15:55:29.240855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D1EF0D5D0>]}
[0m15:55:29.250120 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m15:55:29.711247 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:55:30.260269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:30.261324 [debug] [MainThread]: Partial parsing: updated file: czech_education://models\dimensions\dimareascd.sql
[0m15:55:31.141963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23B7E4D0>]}
[0m15:55:31.279674 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:55:31.326267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:55:31.394124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23D46FD0>]}
[0m15:55:31.397120 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m15:55:31.399116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23BC4510>]}
[0m15:55:31.407132 [info ] [MainThread]: 
[0m15:55:31.409123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:31.412121 [info ] [MainThread]: 
[0m15:55:31.416128 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:55:31.436699 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:55:31.995438 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:55:31.997436 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:55:31.998435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:31.999482 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:55:32.002442 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23C53190>]}
[0m15:55:33.968011 [debug] [ThreadPool]: SQL status: SUCCESS in 1.969 seconds
[0m15:55:33.973019 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:55:33.980278 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m15:55:34.031843 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m15:55:34.034503 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m15:55:34.035504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:34.707350 [debug] [ThreadPool]: SQL status: SUCCESS in 0.671 seconds
[0m15:55:34.711784 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m15:55:34.713781 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m15:55:34.715785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_testnamespace, now list_iceberg_snapshots)
[0m15:55:34.738459 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m15:55:34.739985 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m15:55:34.740987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:35.351998 [debug] [ThreadPool]: SQL status: SUCCESS in 0.610 seconds
[0m15:55:35.355281 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m15:55:35.356912 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m15:55:35.359035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23978C50>]}
[0m15:55:35.361048 [debug] [MainThread]: On master: COMMIT
[0m15:55:35.370109 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m15:55:35.371047 [info ] [Thread-1 (]: 1 of 6 START sql table model testnamespace.spine ............................... [RUN]
[0m15:55:35.374057 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m15:55:35.376049 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m15:55:35.386122 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m15:55:35.388477 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m15:55:35.511808 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.spine"
[0m15:55:35.516725 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:55:35.518726 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

  
    

    create table "iceberg"."testnamespace"."spine__dbt_tmp"
      
      
    as (
      SELECT CURRENT_TIMESTAMP  AS date_day
    )
[0m15:55:35.519726 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:55:37.395106 [debug] [Thread-1 (]: SQL status: CREATE TABLE (1 rows) in 1.875 seconds
[0m15:55:37.411550 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:55:37.413550 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */
alter table "iceberg"."testnamespace"."spine" rename to "iceberg"."testnamespace"."spine__dbt_backup"
[0m15:55:37.703967 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.289 seconds
[0m15:55:37.718998 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:55:37.720654 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */
alter table "iceberg"."testnamespace"."spine__dbt_tmp" rename to "iceberg"."testnamespace"."spine"
[0m15:55:38.120972 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.397 seconds
[0m15:55:38.148865 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."spine__dbt_backup"
[0m15:55:38.159799 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m15:55:38.161558 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

    drop table if exists "iceberg"."testnamespace"."spine__dbt_backup"
[0m15:55:38.258070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.095 seconds
[0m15:55:38.308450 [debug] [Thread-1 (]: On model.czech_education.spine: ROLLBACK
[0m15:55:38.310557 [debug] [Thread-1 (]: On model.czech_education.spine: Close
[0m15:55:38.316556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23CAD810>]}
[0m15:55:38.319177 [info ] [Thread-1 (]: 1 of 6 OK created sql table model testnamespace.spine .......................... [[32mCREATE TABLE (1 rows)[0m in 2.94s]
[0m15:55:38.321676 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m15:55:38.323558 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m15:55:38.327229 [info ] [Thread-1 (]: 2 of 6 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m15:55:38.330240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.spine, now model.czech_education.stg_graduates)
[0m15:55:38.332230 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m15:55:38.338825 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m15:55:38.342824 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m15:55:38.359466 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m15:55:38.365772 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:55:38.367779 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name,
    area_name
FROM iceberg.testnamespace.graduatesview
    )
[0m15:55:38.368779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:39.968818 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 1.599 seconds
[0m15:55:39.980006 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:55:39.981248 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:55:40.222319 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.240 seconds
[0m15:55:40.236628 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:55:40.238279 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m15:55:40.401501 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.161 seconds
[0m15:55:40.410991 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:55:40.413647 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m15:55:40.414858 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m15:55:40.501828 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.086 seconds
[0m15:55:40.506793 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m15:55:40.508182 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m15:55:40.510329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D24438790>]}
[0m15:55:40.512034 [info ] [Thread-1 (]: 2 of 6 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 2.18s]
[0m15:55:40.515046 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m15:55:40.516435 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m15:55:40.518410 [info ] [Thread-1 (]: 3 of 6 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m15:55:40.521405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m15:55:40.523618 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m15:55:40.531884 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m15:55:40.535618 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m15:55:40.550068 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m15:55:40.557940 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:55:40.560953 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m15:55:40.562944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:46.145076 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 5.582 seconds
[0m15:55:46.160857 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:55:46.163680 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:55:46.529981 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.363 seconds
[0m15:55:46.541112 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:55:46.542930 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m15:55:46.799799 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.255 seconds
[0m15:55:46.815490 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:55:46.819974 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m15:55:46.821599 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m15:55:47.209518 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.386 seconds
[0m15:55:47.214113 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m15:55:47.215261 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m15:55:47.217963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D244639D0>]}
[0m15:55:47.220966 [info ] [Thread-1 (]: 3 of 6 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 6.70s]
[0m15:55:47.225061 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m15:55:47.227674 [debug] [Thread-1 (]: Began running node model.czech_education.dimarea
[0m15:55:47.229992 [info ] [Thread-1 (]: 4 of 6 START sql table model testnamespace.dimarea ............................. [RUN]
[0m15:55:47.231997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.dimarea)
[0m15:55:47.236242 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimarea
[0m15:55:47.252455 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimarea"
[0m15:55:47.258921 [debug] [Thread-1 (]: Began executing node model.czech_education.dimarea
[0m15:55:47.283134 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimarea"
[0m15:55:47.291679 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:55:47.293820 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

  
    

    create table "iceberg"."testnamespace"."dimarea__dbt_tmp"
      
      
    as (
      


    SELECT 
        area_code,
        area_name
    FROM "iceberg"."testnamespace"."stg_graduates"
    )
[0m15:55:47.296259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:49.918227 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 2.622 seconds
[0m15:55:49.927762 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:55:49.929955 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea" rename to "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m15:55:50.189849 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.257 seconds
[0m15:55:50.204790 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:55:50.206427 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea__dbt_tmp" rename to "iceberg"."testnamespace"."dimarea"
[0m15:55:50.575097 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.367 seconds
[0m15:55:50.584605 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m15:55:50.587613 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m15:55:50.589649 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

    drop table if exists "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m15:55:50.726523 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.135 seconds
[0m15:55:50.735691 [debug] [Thread-1 (]: On model.czech_education.dimarea: ROLLBACK
[0m15:55:50.738745 [debug] [Thread-1 (]: On model.czech_education.dimarea: Close
[0m15:55:50.742202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D244701D0>]}
[0m15:55:50.744732 [info ] [Thread-1 (]: 4 of 6 OK created sql table model testnamespace.dimarea ........................ [[32mCREATE TABLE (223 rows)[0m in 3.51s]
[0m15:55:50.749277 [debug] [Thread-1 (]: Finished running node model.czech_education.dimarea
[0m15:55:50.751958 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m15:55:50.755963 [info ] [Thread-1 (]: 5 of 6 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m15:55:50.760379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.dimarea, now model.czech_education.fct_regional_education)
[0m15:55:50.762385 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m15:55:50.774676 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m15:55:50.781097 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m15:55:50.797681 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m15:55:50.810105 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:55:50.813708 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m15:55:50.814710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:55.198507 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 4.383 seconds
[0m15:55:55.206506 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:55:55.207504 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:55:55.413422 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.204 seconds
[0m15:55:55.422028 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:55:55.423083 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m15:55:55.559978 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.135 seconds
[0m15:55:55.567757 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:55:55.569773 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m15:55:55.570773 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m15:55:55.684172 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.111 seconds
[0m15:55:55.688624 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m15:55:55.689806 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m15:55:55.691625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D244A3050>]}
[0m15:55:55.694623 [info ] [Thread-1 (]: 5 of 6 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 4.93s]
[0m15:55:55.697128 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m15:55:55.699116 [debug] [Thread-1 (]: Began running node model.czech_education.dimareascd
[0m15:55:55.702119 [info ] [Thread-1 (]: 6 of 6 START sql table model testnamespace.dimareascd .......................... [RUN]
[0m15:55:55.705951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.fct_regional_education, now model.czech_education.dimareascd)
[0m15:55:55.708955 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimareascd
[0m15:55:55.715957 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimareascd"
[0m15:55:55.719353 [debug] [Thread-1 (]: Began executing node model.czech_education.dimareascd
[0m15:55:55.730611 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimareascd"
[0m15:55:55.736344 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimareascd"
[0m15:55:55.739353 [debug] [Thread-1 (]: On model.czech_education.dimareascd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimareascd"} */

  
    

    create table "iceberg"."testnamespace"."dimareascd"
      
      
    as (
      -- models/dim/dim_product_history.sql
SELECT 
    area_code,
    area_name,
    dbt_valid_from as effective_date,
    dbt_valid_to as expiry_date,
    CASE 
        WHEN dbt_valid_to IS NULL THEN 1 
        ELSE 0 
    END as is_current
FROM "iceberg"."snapshots"."area_scd"
ORDER BY   area_code , effective_date
    )
[0m15:55:55.742961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:56.059436 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251105_191159_00176_bzhsk
[0m15:55:56.061631 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 20:6: Schema 'snapshots' does not exist", query_id=20251105_191159_00176_bzhsk)
[0m15:55:56.063683 [debug] [Thread-1 (]: On model.czech_education.dimareascd: ROLLBACK
[0m15:55:56.065920 [debug] [Thread-1 (]: On model.czech_education.dimareascd: Close
[0m15:55:56.096408 [debug] [Thread-1 (]: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 20:6: Schema 'snapshots' does not exist", query_id=20251105_191159_00176_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m15:55:56.099408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e14c18f-e369-4ab2-a273-3050eb522158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D1F0CFD90>]}
[0m15:55:56.101943 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model testnamespace.dimareascd ................. [[31mERROR[0m in 0.39s]
[0m15:55:56.106047 [debug] [Thread-1 (]: Finished running node model.czech_education.dimareascd
[0m15:55:56.108956 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.dimareascd' to be skipped because of status 'error'.  Reason: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 20:6: Schema 'snapshots' does not exist", query_id=20251105_191159_00176_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql.
[0m15:55:56.113955 [debug] [MainThread]: On master: COMMIT
[0m15:55:56.114954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:56.115954 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m15:55:56.117307 [debug] [MainThread]: Connection 'list_iceberg_snapshots' was properly closed.
[0m15:55:56.117956 [debug] [MainThread]: Connection 'model.czech_education.dimareascd' was properly closed.
[0m15:55:56.119956 [info ] [MainThread]: 
[0m15:55:56.121957 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.70 seconds (24.70s).
[0m15:55:56.127897 [debug] [MainThread]: Command end result
[0m15:55:56.192298 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m15:55:56.198704 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m15:55:56.211881 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m15:55:56.212813 [info ] [MainThread]: 
[0m15:55:56.214812 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:55:56.217810 [info ] [MainThread]: 
[0m15:55:56.223161 [error] [MainThread]: [31mFailure in model dimareascd (models\dimensions\dimareascd.sql)[0m
[0m15:55:56.227157 [error] [MainThread]:   Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 20:6: Schema 'snapshots' does not exist", query_id=20251105_191159_00176_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m15:55:56.229159 [info ] [MainThread]: 
[0m15:55:56.231191 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\dimensions\dimareascd.sql
[0m15:55:56.233159 [info ] [MainThread]: 
[0m15:55:56.235950 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m15:55:56.247970 [debug] [MainThread]: Command `dbt run` failed at 15:55:56.246965 after 28.68 seconds
[0m15:55:56.248985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D222A3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D21E147D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D1BAF66D0>]}
[0m15:55:56.250971 [debug] [MainThread]: Flushing usage events
[0m15:55:57.919614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:13.863701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD6D6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD71A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD719950>]}


============================== 16:01:13.888887 | 5cb5e631-1492-4098-85b7-343b3dd8018d ==============================
[0m16:01:13.888887 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:01:13.893894 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:01:16.687286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CDC4A950>]}
[0m16:01:16.891779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CA3BD250>]}
[0m16:01:16.893476 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m16:01:17.628890 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:01:18.542753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:18.544909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:18.748914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CF028390>]}
[0m16:01:18.931903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:01:18.943564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:01:18.987611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CF07C090>]}
[0m16:01:18.990071 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m16:01:18.993069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CDDFB810>]}
[0m16:01:19.000118 [info ] [MainThread]: 
[0m16:01:19.003120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:19.006121 [info ] [MainThread]: 
[0m16:01:19.011713 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:01:19.030717 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:01:20.260406 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:01:20.263355 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:01:20.265842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:20.268364 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m16:01:20.273090 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CF094610>]}
[0m16:01:20.480939 [debug] [ThreadPool]: SQL status: SUCCESS in 0.214 seconds
[0m16:01:20.486342 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:01:20.493150 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_snapshots'
[0m16:01:20.541674 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m16:01:20.542836 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m16:01:20.544948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:21.009875 [debug] [ThreadPool]: SQL status: SUCCESS in 0.465 seconds
[0m16:01:21.016260 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m16:01:21.018282 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m16:01:21.021882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_snapshots, now list_iceberg_testnamespace)
[0m16:01:21.041575 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m16:01:21.043513 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m16:01:21.044603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:21.228625 [debug] [ThreadPool]: SQL status: SUCCESS in 0.184 seconds
[0m16:01:21.234611 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m16:01:21.235611 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m16:01:21.244511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CDE45AD0>]}
[0m16:01:21.246511 [debug] [MainThread]: On master: COMMIT
[0m16:01:21.254844 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m16:01:21.257261 [info ] [Thread-1 (]: 1 of 6 START sql table model testnamespace.spine ............................... [RUN]
[0m16:01:21.259796 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m16:01:21.262797 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m16:01:21.268790 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m16:01:21.271840 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m16:01:21.389472 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.spine"
[0m16:01:21.412101 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:01:21.415047 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

  
    

    create table "iceberg"."testnamespace"."spine__dbt_tmp"
      
      
    as (
      SELECT CURRENT_TIMESTAMP  AS date_day
    )
[0m16:01:21.418049 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:01:23.020532 [debug] [Thread-1 (]: SQL status: CREATE TABLE (1 rows) in 1.603 seconds
[0m16:01:23.073243 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:01:23.077253 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */
alter table "iceberg"."testnamespace"."spine" rename to "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:01:23.339696 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.259 seconds
[0m16:01:23.356791 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:01:23.359603 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */
alter table "iceberg"."testnamespace"."spine__dbt_tmp" rename to "iceberg"."testnamespace"."spine"
[0m16:01:23.660211 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.296 seconds
[0m16:01:23.696816 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:01:23.709815 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:01:23.712816 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

    drop table if exists "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:01:23.873507 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.158 seconds
[0m16:01:23.981226 [debug] [Thread-1 (]: On model.czech_education.spine: ROLLBACK
[0m16:01:23.984232 [debug] [Thread-1 (]: On model.czech_education.spine: Close
[0m16:01:23.996560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CDC8C2D0>]}
[0m16:01:24.000235 [info ] [Thread-1 (]: 1 of 6 OK created sql table model testnamespace.spine .......................... [[32mCREATE TABLE (1 rows)[0m in 2.73s]
[0m16:01:24.007235 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m16:01:24.011276 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m16:01:24.016034 [info ] [Thread-1 (]: 2 of 6 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m16:01:24.023344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.spine, now model.czech_education.stg_graduates)
[0m16:01:24.026228 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m16:01:24.174249 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m16:01:24.193363 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m16:01:24.205259 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m16:01:24.212349 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:01:24.214360 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name,
    area_name
FROM iceberg.testnamespace.graduatesview
    )
[0m16:01:24.216347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:25.493834 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 1.277 seconds
[0m16:01:25.510426 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:01:25.514421 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:01:25.790664 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.271 seconds
[0m16:01:25.801960 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:01:25.803404 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m16:01:26.098757 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.292 seconds
[0m16:01:26.108779 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:01:26.111942 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:01:26.113854 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:01:26.316466 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.201 seconds
[0m16:01:26.330479 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m16:01:26.334137 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m16:01:26.339293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD8F7710>]}
[0m16:01:26.346122 [info ] [Thread-1 (]: 2 of 6 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 2.32s]
[0m16:01:26.352119 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m16:01:26.355124 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m16:01:26.362288 [info ] [Thread-1 (]: 3 of 6 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m16:01:26.367300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m16:01:26.370298 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m16:01:26.387306 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m16:01:26.396311 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m16:01:26.416297 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m16:01:26.431513 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:01:26.435514 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m16:01:26.438515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:29.094380 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 2.656 seconds
[0m16:01:29.106497 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:01:29.109510 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:01:29.273497 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.162 seconds
[0m16:01:29.295747 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:01:29.299879 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m16:01:29.510741 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.208 seconds
[0m16:01:29.528574 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:01:29.532574 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:01:29.534577 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:01:29.680623 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.143 seconds
[0m16:01:29.688332 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m16:01:29.690170 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m16:01:29.694170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CEF4E7D0>]}
[0m16:01:29.698032 [info ] [Thread-1 (]: 3 of 6 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 3.33s]
[0m16:01:29.702030 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m16:01:29.704306 [debug] [Thread-1 (]: Began running node model.czech_education.dimarea
[0m16:01:29.708295 [info ] [Thread-1 (]: 4 of 6 START sql table model testnamespace.dimarea ............................. [RUN]
[0m16:01:29.711886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.dimarea)
[0m16:01:29.713931 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimarea
[0m16:01:29.728886 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimarea"
[0m16:01:29.733624 [debug] [Thread-1 (]: Began executing node model.czech_education.dimarea
[0m16:01:29.748622 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimarea"
[0m16:01:29.756624 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:01:29.758624 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

  
    

    create table "iceberg"."testnamespace"."dimarea__dbt_tmp"
      
      
    as (
      


    SELECT 
        area_code,
        area_name
    FROM "iceberg"."testnamespace"."stg_graduates"
    )
[0m16:01:29.759622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:30.664743 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.904 seconds
[0m16:01:30.678721 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:01:30.682723 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea" rename to "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:01:30.807004 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.121 seconds
[0m16:01:30.814618 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:01:30.816619 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea__dbt_tmp" rename to "iceberg"."testnamespace"."dimarea"
[0m16:01:30.977773 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.160 seconds
[0m16:01:30.984585 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:01:30.987587 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:01:30.988588 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

    drop table if exists "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:01:31.124663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.134 seconds
[0m16:01:31.131085 [debug] [Thread-1 (]: On model.czech_education.dimarea: ROLLBACK
[0m16:01:31.134102 [debug] [Thread-1 (]: On model.czech_education.dimarea: Close
[0m16:01:31.137808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CF4A2F90>]}
[0m16:01:31.141105 [info ] [Thread-1 (]: 4 of 6 OK created sql table model testnamespace.dimarea ........................ [[32mCREATE TABLE (223 rows)[0m in 1.42s]
[0m16:01:31.144100 [debug] [Thread-1 (]: Finished running node model.czech_education.dimarea
[0m16:01:31.148102 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m16:01:31.152350 [info ] [Thread-1 (]: 5 of 6 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m16:01:31.155698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.dimarea, now model.czech_education.fct_regional_education)
[0m16:01:31.158512 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m16:01:31.173195 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m16:01:31.177333 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m16:01:31.189743 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m16:01:31.198794 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:01:31.199920 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m16:01:31.200908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:32.124071 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 0.923 seconds
[0m16:01:32.133671 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:01:32.134671 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:01:32.278566 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.142 seconds
[0m16:01:32.289385 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:01:32.291379 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m16:01:32.482066 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.189 seconds
[0m16:01:32.499212 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:01:32.504094 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:01:32.506096 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:01:32.642689 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.133 seconds
[0m16:01:32.650060 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m16:01:32.651670 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m16:01:32.655238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CF323C90>]}
[0m16:01:32.660903 [info ] [Thread-1 (]: 5 of 6 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 1.50s]
[0m16:01:32.665839 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m16:01:32.667838 [debug] [Thread-1 (]: Began running node model.czech_education.dimareascd
[0m16:01:32.669840 [info ] [Thread-1 (]: 6 of 6 START sql table model testnamespace.dimareascd .......................... [RUN]
[0m16:01:32.672370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.fct_regional_education, now model.czech_education.dimareascd)
[0m16:01:32.675003 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimareascd
[0m16:01:32.686028 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimareascd"
[0m16:01:32.689071 [debug] [Thread-1 (]: Began executing node model.czech_education.dimareascd
[0m16:01:32.708048 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimareascd"
[0m16:01:32.717612 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimareascd"
[0m16:01:32.719138 [debug] [Thread-1 (]: On model.czech_education.dimareascd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimareascd"} */

  
    

    create table "iceberg"."testnamespace"."dimareascd"
      
      
    as (
      -- models/dim/dim_product_history.sql
SELECT 
    area_code,
    area_name,
    dbt_valid_from as effective_date,
    dbt_valid_to as expiry_date,
    CASE 
        WHEN dbt_valid_to IS NULL THEN 1 
        ELSE 0 
    END as is_current
FROM "iceberg"."snapshots"."area_scd"
ORDER BY   area_code , effective_date
    )
[0m16:01:32.721903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:32.819166 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251105_191736_00205_bzhsk
[0m16:01:32.823688 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 20:6: Table 'iceberg.snapshots.area_scd' does not exist", query_id=20251105_191736_00205_bzhsk)
[0m16:01:32.827688 [debug] [Thread-1 (]: On model.czech_education.dimareascd: ROLLBACK
[0m16:01:32.831112 [debug] [Thread-1 (]: On model.czech_education.dimareascd: Close
[0m16:01:32.875889 [debug] [Thread-1 (]: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 20:6: Table 'iceberg.snapshots.area_scd' does not exist", query_id=20251105_191736_00205_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m16:01:32.878898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb5e631-1492-4098-85b7-343b3dd8018d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CF05F7D0>]}
[0m16:01:32.883439 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model testnamespace.dimareascd ................. [[31mERROR[0m in 0.21s]
[0m16:01:32.888441 [debug] [Thread-1 (]: Finished running node model.czech_education.dimareascd
[0m16:01:32.892450 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.dimareascd' to be skipped because of status 'error'.  Reason: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 20:6: Table 'iceberg.snapshots.area_scd' does not exist", query_id=20251105_191736_00205_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql.
[0m16:01:32.899447 [debug] [MainThread]: On master: COMMIT
[0m16:01:32.902854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:32.904848 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m16:01:32.906103 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m16:01:32.909509 [debug] [MainThread]: Connection 'model.czech_education.dimareascd' was properly closed.
[0m16:01:32.912515 [info ] [MainThread]: 
[0m16:01:32.915510 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 13.90 seconds (13.90s).
[0m16:01:32.923032 [debug] [MainThread]: Command end result
[0m16:01:33.023382 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:01:33.038495 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:01:33.075337 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m16:01:33.078339 [info ] [MainThread]: 
[0m16:01:33.082339 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:01:33.086966 [info ] [MainThread]: 
[0m16:01:33.093172 [error] [MainThread]: [31mFailure in model dimareascd (models\dimensions\dimareascd.sql)[0m
[0m16:01:33.100169 [error] [MainThread]:   Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 20:6: Table 'iceberg.snapshots.area_scd' does not exist", query_id=20251105_191736_00205_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m16:01:33.105171 [info ] [MainThread]: 
[0m16:01:33.111774 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\dimensions\dimareascd.sql
[0m16:01:33.118024 [info ] [MainThread]: 
[0m16:01:33.124028 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m16:01:33.137118 [debug] [MainThread]: Command `dbt run` failed at 16:01:33.136117 after 19.75 seconds
[0m16:01:33.140117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C70066D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C7006A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD73D850>]}
[0m16:01:33.145124 [debug] [MainThread]: Flushing usage events
[0m16:01:35.213793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:33.530276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E71B36D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E71B7B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E71724190>]}


============================== 16:03:33.544648 | 34faca08-13c1-469d-9ace-35cc917768ae ==============================
[0m16:03:33.544648 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:03:33.546648 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m16:03:35.563377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E71FF4110>]}
[0m16:03:35.821197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E6E81DF90>]}
[0m16:03:35.823200 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m16:03:37.093383 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:03:37.899605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:37.902910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:38.132881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E72110050>]}
[0m16:03:38.396156 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:03:38.409739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:03:38.458098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E720963D0>]}
[0m16:03:38.460619 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m16:03:38.462509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7322FB10>]}
[0m16:03:38.468505 [info ] [MainThread]: 
[0m16:03:38.470717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:38.472683 [info ] [MainThread]: 
[0m16:03:38.475339 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:03:38.494412 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:03:39.507956 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:03:39.511873 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:03:39.514885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:39.516881 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m16:03:39.520888 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7356F610>]}
[0m16:03:43.741449 [debug] [ThreadPool]: SQL status: SUCCESS in 4.225 seconds
[0m16:03:43.750446 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:03:43.760123 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m16:03:43.798646 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m16:03:43.800009 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m16:03:43.800648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:44.377890 [debug] [ThreadPool]: SQL status: SUCCESS in 0.577 seconds
[0m16:03:44.383214 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m16:03:44.384844 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m16:03:44.387843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_testnamespace, now list_iceberg_snapshots)
[0m16:03:44.404030 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m16:03:44.405837 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m16:03:44.406839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:44.664409 [debug] [ThreadPool]: SQL status: SUCCESS in 0.258 seconds
[0m16:03:44.667650 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m16:03:44.668863 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m16:03:44.670708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7353FB90>]}
[0m16:03:44.672350 [debug] [MainThread]: On master: COMMIT
[0m16:03:44.679989 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m16:03:44.681988 [info ] [Thread-1 (]: 1 of 6 START sql table model testnamespace.spine ............................... [RUN]
[0m16:03:44.684649 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m16:03:44.685643 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m16:03:44.691232 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m16:03:44.694358 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m16:03:44.820136 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.spine"
[0m16:03:44.830882 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:03:44.833133 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

  
    

    create table "iceberg"."testnamespace"."spine__dbt_tmp"
      
      
    as (
      SELECT CURRENT_TIMESTAMP  AS date_day
    )
[0m16:03:44.835889 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:47.297797 [debug] [Thread-1 (]: SQL status: CREATE TABLE (1 rows) in 2.462 seconds
[0m16:03:47.314885 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:03:47.315884 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */
alter table "iceberg"."testnamespace"."spine" rename to "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:03:47.515111 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.197 seconds
[0m16:03:47.525111 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:03:47.527112 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */
alter table "iceberg"."testnamespace"."spine__dbt_tmp" rename to "iceberg"."testnamespace"."spine"
[0m16:03:47.699916 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.171 seconds
[0m16:03:47.735140 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:03:47.744182 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:03:47.746187 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

    drop table if exists "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:03:47.819434 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.071 seconds
[0m16:03:47.890525 [debug] [Thread-1 (]: On model.czech_education.spine: ROLLBACK
[0m16:03:47.892507 [debug] [Thread-1 (]: On model.czech_education.spine: Close
[0m16:03:47.902507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E720F04D0>]}
[0m16:03:47.905360 [info ] [Thread-1 (]: 1 of 6 OK created sql table model testnamespace.spine .......................... [[32mCREATE TABLE (1 rows)[0m in 3.21s]
[0m16:03:47.909371 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m16:03:47.914368 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m16:03:47.918355 [info ] [Thread-1 (]: 2 of 6 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m16:03:47.921358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.spine, now model.czech_education.stg_graduates)
[0m16:03:47.923351 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m16:03:48.035517 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m16:03:48.039538 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m16:03:48.049205 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m16:03:48.054637 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:03:48.055207 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name,
    area_name
FROM iceberg.testnamespace.graduatesview
    )
[0m16:03:48.057376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:49.178394 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 1.120 seconds
[0m16:03:49.194417 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:03:49.196406 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:03:49.342726 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.143 seconds
[0m16:03:49.356935 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:03:49.358941 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m16:03:49.475915 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.115 seconds
[0m16:03:49.486160 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:03:49.489303 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:03:49.490577 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:03:49.564506 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.072 seconds
[0m16:03:49.570093 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m16:03:49.571407 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m16:03:49.574412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7029A450>]}
[0m16:03:49.577413 [info ] [Thread-1 (]: 2 of 6 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.65s]
[0m16:03:49.580412 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m16:03:49.583410 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m16:03:49.585413 [info ] [Thread-1 (]: 3 of 6 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m16:03:49.587721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m16:03:49.589625 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m16:03:49.598412 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m16:03:49.603324 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m16:03:49.613814 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m16:03:49.619316 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:03:49.620659 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m16:03:49.622423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:52.887434 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 3.265 seconds
[0m16:03:52.896210 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:03:52.898281 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:03:53.076787 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.177 seconds
[0m16:03:53.096324 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:03:53.099501 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m16:03:53.315525 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.214 seconds
[0m16:03:53.339901 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:03:53.346235 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:03:53.349124 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:03:53.418373 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.065 seconds
[0m16:03:53.428460 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m16:03:53.430548 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m16:03:53.433551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E738FF6D0>]}
[0m16:03:53.436544 [info ] [Thread-1 (]: 3 of 6 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 3.85s]
[0m16:03:53.440216 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m16:03:53.441217 [debug] [Thread-1 (]: Began running node model.czech_education.dimarea
[0m16:03:53.445401 [info ] [Thread-1 (]: 4 of 6 START sql table model testnamespace.dimarea ............................. [RUN]
[0m16:03:53.449219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.dimarea)
[0m16:03:53.451220 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimarea
[0m16:03:53.463015 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimarea"
[0m16:03:53.468841 [debug] [Thread-1 (]: Began executing node model.czech_education.dimarea
[0m16:03:53.481838 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimarea"
[0m16:03:53.487836 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:03:53.488839 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

  
    

    create table "iceberg"."testnamespace"."dimarea__dbt_tmp"
      
      
    as (
      


    SELECT 
        area_code,
        area_name
    FROM "iceberg"."testnamespace"."stg_graduates"
    )
[0m16:03:53.490721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:54.477874 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.986 seconds
[0m16:03:54.523821 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:03:54.534703 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea" rename to "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:03:54.749143 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.204 seconds
[0m16:03:54.763605 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:03:54.764769 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea__dbt_tmp" rename to "iceberg"."testnamespace"."dimarea"
[0m16:03:54.869640 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.103 seconds
[0m16:03:54.875934 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:03:54.878771 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:03:54.879773 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

    drop table if exists "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:03:55.058264 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.176 seconds
[0m16:03:55.071720 [debug] [Thread-1 (]: On model.czech_education.dimarea: ROLLBACK
[0m16:03:55.074727 [debug] [Thread-1 (]: On model.czech_education.dimarea: Close
[0m16:03:55.080743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E738BBC90>]}
[0m16:03:55.086014 [info ] [Thread-1 (]: 4 of 6 OK created sql table model testnamespace.dimarea ........................ [[32mCREATE TABLE (223 rows)[0m in 1.63s]
[0m16:03:55.090730 [debug] [Thread-1 (]: Finished running node model.czech_education.dimarea
[0m16:03:55.095733 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m16:03:55.101728 [info ] [Thread-1 (]: 5 of 6 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m16:03:55.105733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.dimarea, now model.czech_education.fct_regional_education)
[0m16:03:55.110733 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m16:03:55.133737 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m16:03:55.140157 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m16:03:55.161312 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m16:03:55.182037 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:03:55.185041 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m16:03:55.189040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:58.347743 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 3.158 seconds
[0m16:03:58.359178 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:03:58.360634 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:03:58.494395 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.132 seconds
[0m16:03:58.506176 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:03:58.507180 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m16:03:58.665535 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.155 seconds
[0m16:03:58.679363 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:03:58.682366 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:03:58.684366 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:03:58.805628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.119 seconds
[0m16:03:58.815646 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m16:03:58.818647 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m16:03:58.821651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E71FCEAD0>]}
[0m16:03:58.825646 [info ] [Thread-1 (]: 5 of 6 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 3.72s]
[0m16:03:58.831859 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m16:03:58.836311 [debug] [Thread-1 (]: Began running node model.czech_education.dimareascd
[0m16:03:58.839383 [info ] [Thread-1 (]: 6 of 6 START sql table model testnamespace.dimareascd .......................... [RUN]
[0m16:03:58.844522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.fct_regional_education, now model.czech_education.dimareascd)
[0m16:03:58.846517 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimareascd
[0m16:03:58.860672 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimareascd"
[0m16:03:58.865809 [debug] [Thread-1 (]: Began executing node model.czech_education.dimareascd
[0m16:03:58.887536 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimareascd"
[0m16:03:58.899476 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimareascd"
[0m16:03:58.902364 [debug] [Thread-1 (]: On model.czech_education.dimareascd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimareascd"} */

  
    

    create table "iceberg"."testnamespace"."dimareascd"
      
      
    as (
      -- models/dim/dim_product_history.sql
SELECT 
    area_code,
    area_name,
    dbt_valid_from as effective_date,
    dbt_valid_to as expiry_date,
    CASE 
        WHEN dbt_valid_to IS NULL THEN 1 
        ELSE 0 
    END as is_current
FROM "iceberg"."snapshots"."area_scd"
ORDER BY   area_code , effective_date
    )
[0m16:03:58.905867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:58.993408 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251105_192002_00229_bzhsk
[0m16:03:58.996712 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 20:6: Table 'iceberg.snapshots.area_scd' does not exist", query_id=20251105_192002_00229_bzhsk)
[0m16:03:58.999652 [debug] [Thread-1 (]: On model.czech_education.dimareascd: ROLLBACK
[0m16:03:59.002313 [debug] [Thread-1 (]: On model.czech_education.dimareascd: Close
[0m16:03:59.048166 [debug] [Thread-1 (]: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 20:6: Table 'iceberg.snapshots.area_scd' does not exist", query_id=20251105_192002_00229_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m16:03:59.051430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34faca08-13c1-469d-9ace-35cc917768ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7393BC50>]}
[0m16:03:59.055440 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model testnamespace.dimareascd ................. [[31mERROR[0m in 0.21s]
[0m16:03:59.060239 [debug] [Thread-1 (]: Finished running node model.czech_education.dimareascd
[0m16:03:59.063595 [debug] [Thread-4 (]: Marking all children of 'model.czech_education.dimareascd' to be skipped because of status 'error'.  Reason: Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 20:6: Table 'iceberg.snapshots.area_scd' does not exist", query_id=20251105_192002_00229_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql.
[0m16:03:59.071232 [debug] [MainThread]: On master: COMMIT
[0m16:03:59.074236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:59.079235 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m16:03:59.081232 [debug] [MainThread]: Connection 'list_iceberg_snapshots' was properly closed.
[0m16:03:59.084234 [debug] [MainThread]: Connection 'model.czech_education.dimareascd' was properly closed.
[0m16:03:59.086973 [info ] [MainThread]: 
[0m16:03:59.089972 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 20.61 seconds (20.61s).
[0m16:03:59.101520 [debug] [MainThread]: Command end result
[0m16:03:59.182773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:03:59.190772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:03:59.207332 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m16:03:59.208337 [info ] [MainThread]: 
[0m16:03:59.210332 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:03:59.214334 [info ] [MainThread]: 
[0m16:03:59.221331 [error] [MainThread]: [31mFailure in model dimareascd (models\dimensions\dimareascd.sql)[0m
[0m16:03:59.223333 [error] [MainThread]:   Database Error in model dimareascd (models\dimensions\dimareascd.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 20:6: Table 'iceberg.snapshots.area_scd' does not exist", query_id=20251105_192002_00229_bzhsk)
  compiled code at target\run\czech_education\models\dimensions\dimareascd.sql
[0m16:03:59.226333 [info ] [MainThread]: 
[0m16:03:59.229563 [info ] [MainThread]:   compiled code at target\compiled\czech_education\models\dimensions\dimareascd.sql
[0m16:03:59.232132 [info ] [MainThread]: 
[0m16:03:59.239122 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m16:03:59.248271 [debug] [MainThread]: Command `dbt run` failed at 16:03:59.247377 after 25.96 seconds
[0m16:03:59.251042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E6B3C66D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E6B3C6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E71B3C550>]}
[0m16:03:59.253711 [debug] [MainThread]: Flushing usage events
[0m16:04:01.167232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:23.078889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229075671D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229075A6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229075A4550>]}


============================== 16:04:23.093844 | 5e0f94cc-d935-4361-a20b-36b463508386 ==============================
[0m16:04:23.093844 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:04:23.099859 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select area_scd', 'printer_width': '80', 'target_path': 'None'}
[0m16:04:25.028801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0f94cc-d935-4361-a20b-36b463508386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022907A40990>]}
[0m16:04:25.253724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e0f94cc-d935-4361-a20b-36b463508386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229042524D0>]}
[0m16:04:25.255676 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m16:04:26.053016 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:04:26.676170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:26.677971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:26.854765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e0f94cc-d935-4361-a20b-36b463508386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908EEFF10>]}
[0m16:04:27.170018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:04:27.181061 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:04:27.224097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e0f94cc-d935-4361-a20b-36b463508386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229075E1A50>]}
[0m16:04:27.227139 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m16:04:27.230093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0f94cc-d935-4361-a20b-36b463508386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908F47BD0>]}
[0m16:04:27.237385 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:04:27.243430 [debug] [MainThread]: Command end result
[0m16:04:27.324618 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:04:27.334943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:04:27.344630 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m16:04:27.348921 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:27.347881 after 4.50 seconds
[0m16:04:27.349922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022907564050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022907606250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290704F110>]}
[0m16:04:27.351884 [debug] [MainThread]: Flushing usage events
[0m16:04:29.072334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:57.292277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A4D6BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A51DAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A547F50>]}


============================== 16:05:57.307602 | 41980b9b-1be5-4fff-8dde-e57459074696 ==============================
[0m16:05:57.307602 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:05:57.310948 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m16:05:59.817610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41980b9b-1be5-4fff-8dde-e57459074696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A9B32D0>]}
[0m16:06:00.220290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41980b9b-1be5-4fff-8dde-e57459074696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD171BD510>]}
[0m16:06:00.224717 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m16:06:01.257445 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:06:02.257266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:02.259509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:02.526733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41980b9b-1be5-4fff-8dde-e57459074696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A8A3A90>]}
[0m16:06:02.890377 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:06:02.903429 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:06:02.949670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41980b9b-1be5-4fff-8dde-e57459074696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A4DDF50>]}
[0m16:06:02.951667 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m16:06:02.953829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41980b9b-1be5-4fff-8dde-e57459074696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD192E55D0>]}
[0m16:06:02.959449 [info ] [MainThread]: 
[0m16:06:02.962523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:02.965446 [info ] [MainThread]: 
[0m16:06:02.969451 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:06:02.976490 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:06:03.799099 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:06:03.802094 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:06:03.803390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:03.805136 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m16:06:03.809103 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '41980b9b-1be5-4fff-8dde-e57459074696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD19291F50>]}
[0m16:06:05.891203 [debug] [ThreadPool]: SQL status: SUCCESS in 2.087 seconds
[0m16:06:05.896425 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:06:05.926821 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m16:06:05.969302 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m16:06:05.971128 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m16:06:05.972129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:06.207104 [debug] [ThreadPool]: SQL status: SUCCESS in 0.235 seconds
[0m16:06:06.212043 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m16:06:06.213099 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m16:06:06.215668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_testnamespace, now list_iceberg_snapshots)
[0m16:06:06.233517 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m16:06:06.234516 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m16:06:06.236512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:06.411780 [debug] [ThreadPool]: SQL status: SUCCESS in 0.175 seconds
[0m16:06:06.416612 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m16:06:06.417720 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m16:06:06.420718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41980b9b-1be5-4fff-8dde-e57459074696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1BE1AD10>]}
[0m16:06:06.422714 [debug] [MainThread]: On master: COMMIT
[0m16:06:06.434958 [debug] [Thread-1 (]: Began running node snapshot.czech_education.area_scd
[0m16:06:06.438068 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.area_scd ....................................... [RUN]
[0m16:06:06.442019 [debug] [Thread-1 (]: Acquiring new trino connection 'snapshot.czech_education.area_scd'
[0m16:06:06.444023 [debug] [Thread-1 (]: Began compiling node snapshot.czech_education.area_scd
[0m16:06:06.456900 [debug] [Thread-1 (]: Began executing node snapshot.czech_education.area_scd
[0m16:06:06.714423 [debug] [Thread-1 (]: Using trino connection "snapshot.czech_education.area_scd"
[0m16:06:06.715726 [debug] [Thread-1 (]: On snapshot.czech_education.area_scd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "snapshot.czech_education.area_scd"} */
select * from (
        
    

    select *,
        lower(to_hex(md5(to_utf8(concat(coalesce(cast(area_code as varchar), ''), '|',coalesce(cast(
    current_timestamp
 as varchar), '')))))) as dbt_scd_id,
        
    current_timestamp
 as dbt_updated_at,
        
    current_timestamp
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp
, 
    current_timestamp
), null)
  as dbt_valid_to
from (
        

    

    SELECT 
        area_code,
        area_name
    FROM "iceberg"."testnamespace"."dimarea"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m16:06:06.717426 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:06:06.922558 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.205 seconds
[0m16:06:06.948571 [debug] [Thread-1 (]: Using trino connection "snapshot.czech_education.area_scd"
[0m16:06:06.951249 [debug] [Thread-1 (]: On snapshot.czech_education.area_scd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "snapshot.czech_education.area_scd"} */
select * from (
        select 
    current_timestamp
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m16:06:07.059259 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.105 seconds
[0m16:06:07.062131 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.czech_education.area_scd"
[0m16:06:07.106629 [debug] [Thread-1 (]: Using trino connection "snapshot.czech_education.area_scd"
[0m16:06:07.107624 [debug] [Thread-1 (]: On snapshot.czech_education.area_scd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "snapshot.czech_education.area_scd"} */

      
  
    

    create table "iceberg"."snapshots"."area_scd"
      
      
    as (
      
    

    select *,
        lower(to_hex(md5(to_utf8(concat(coalesce(cast(area_code as varchar), ''), '|',coalesce(cast(
    current_timestamp
 as varchar), '')))))) as dbt_scd_id,
        
    current_timestamp
 as dbt_updated_at,
        
    current_timestamp
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp
, 
    current_timestamp
), null)
  as dbt_valid_to
from (
        

    

    SELECT 
        area_code,
        area_name
    FROM "iceberg"."testnamespace"."dimarea"

    ) sbq



    )
[0m16:06:08.525061 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 1.414 seconds
[0m16:06:08.697982 [debug] [Thread-1 (]: On snapshot.czech_education.area_scd: COMMIT
[0m16:06:08.708993 [debug] [Thread-1 (]: On snapshot.czech_education.area_scd: Close
[0m16:06:08.723987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41980b9b-1be5-4fff-8dde-e57459074696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1C280350>]}
[0m16:06:08.729991 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.area_scd ....................................... [[32mCREATE TABLE (223 rows)[0m in 2.27s]
[0m16:06:08.736671 [debug] [Thread-1 (]: Finished running node snapshot.czech_education.area_scd
[0m16:06:08.743710 [debug] [MainThread]: On master: COMMIT
[0m16:06:08.746667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:08.750663 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m16:06:08.753713 [debug] [MainThread]: Connection 'list_iceberg_snapshots' was properly closed.
[0m16:06:08.756679 [debug] [MainThread]: Connection 'snapshot.czech_education.area_scd' was properly closed.
[0m16:06:08.758656 [info ] [MainThread]: 
[0m16:06:08.763661 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m16:06:08.775664 [debug] [MainThread]: Command end result
[0m16:06:09.072046 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:06:09.104117 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:06:09.153195 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m16:06:09.157192 [info ] [MainThread]: 
[0m16:06:09.162202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:09.167214 [info ] [MainThread]: 
[0m16:06:09.172308 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:06:09.178200 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:06:09.177205 after 12.23 seconds
[0m16:06:09.182204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD13D5BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD13CD58D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD13CD5A10>]}
[0m16:06:09.185622 [debug] [MainThread]: Flushing usage events
[0m16:06:11.009532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:25.717008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F60656DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F60695AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F606C3390>]}


============================== 16:06:25.731993 | c42b9439-0a78-4772-8153-8aab54847a71 ==============================
[0m16:06:25.731993 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:06:25.734962 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:06:27.714980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F60B8BC10>]}
[0m16:06:27.968636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5D32E510>]}
[0m16:06:27.970799 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m16:06:28.974635 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:06:29.788961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:29.792746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:29.978878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F61D91B90>]}
[0m16:06:30.261366 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:06:30.272360 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:06:30.320017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F61EC8390>]}
[0m16:06:30.323015 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m16:06:30.328014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F60C33310>]}
[0m16:06:30.338026 [info ] [MainThread]: 
[0m16:06:30.342017 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:30.346903 [info ] [MainThread]: 
[0m16:06:30.350904 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:06:30.383696 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:06:31.135980 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:06:31.144468 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:06:31.145905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:31.147535 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m16:06:31.149813 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F606D0090>]}
[0m16:06:31.381170 [debug] [ThreadPool]: SQL status: SUCCESS in 0.235 seconds
[0m16:06:31.386248 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:06:31.393830 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_snapshots'
[0m16:06:31.462379 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m16:06:31.466198 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m16:06:31.467785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:31.760020 [debug] [ThreadPool]: SQL status: SUCCESS in 0.291 seconds
[0m16:06:31.765489 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m16:06:31.768198 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m16:06:31.771204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_snapshots, now list_iceberg_testnamespace)
[0m16:06:31.829567 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m16:06:31.831388 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m16:06:31.833840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:32.100730 [debug] [ThreadPool]: SQL status: SUCCESS in 0.267 seconds
[0m16:06:32.107117 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m16:06:32.108642 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m16:06:32.117867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F61EC82D0>]}
[0m16:06:32.119568 [debug] [MainThread]: On master: COMMIT
[0m16:06:32.130635 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m16:06:32.133633 [info ] [Thread-1 (]: 1 of 6 START sql table model testnamespace.spine ............................... [RUN]
[0m16:06:32.137634 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m16:06:32.141648 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m16:06:32.149864 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m16:06:32.152843 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m16:06:32.402346 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.spine"
[0m16:06:32.414682 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:06:32.416746 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

  
    

    create table "iceberg"."testnamespace"."spine__dbt_tmp"
      
      
    as (
      SELECT CURRENT_TIMESTAMP  AS date_day
    )
[0m16:06:32.419746 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:06:33.237665 [debug] [Thread-1 (]: SQL status: CREATE TABLE (1 rows) in 0.818 seconds
[0m16:06:33.271807 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:06:33.273807 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */
alter table "iceberg"."testnamespace"."spine" rename to "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:06:33.446272 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.169 seconds
[0m16:06:33.468918 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:06:33.471470 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */
alter table "iceberg"."testnamespace"."spine__dbt_tmp" rename to "iceberg"."testnamespace"."spine"
[0m16:06:33.692921 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.218 seconds
[0m16:06:33.722135 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:06:33.734665 [debug] [Thread-1 (]: Using trino connection "model.czech_education.spine"
[0m16:06:33.736909 [debug] [Thread-1 (]: On model.czech_education.spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.spine"} */

    drop table if exists "iceberg"."testnamespace"."spine__dbt_backup"
[0m16:06:33.870660 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.132 seconds
[0m16:06:33.962461 [debug] [Thread-1 (]: On model.czech_education.spine: ROLLBACK
[0m16:06:33.964464 [debug] [Thread-1 (]: On model.czech_education.spine: Close
[0m16:06:33.972755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F60C109D0>]}
[0m16:06:33.974747 [info ] [Thread-1 (]: 1 of 6 OK created sql table model testnamespace.spine .......................... [[32mCREATE TABLE (1 rows)[0m in 1.83s]
[0m16:06:33.978752 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m16:06:33.982122 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m16:06:33.984706 [info ] [Thread-1 (]: 2 of 6 START sql table model testnamespace.stg_graduates ....................... [RUN]
[0m16:06:33.988707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.spine, now model.czech_education.stg_graduates)
[0m16:06:33.991583 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m16:06:34.118940 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m16:06:34.123557 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m16:06:34.140642 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_graduates"
[0m16:06:34.161063 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:06:34.163077 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

  
    

    create table "iceberg"."testnamespace"."stg_graduates__dbt_tmp"
      
      
    as (
      SELECT
    university_name,
    area_code,
    CAST(absolvents_count AS INTEGER) AS graduate_count,
    study_program_name,
    area_name
FROM iceberg.testnamespace.graduatesview
    )
[0m16:06:34.165967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:35.102213 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.936 seconds
[0m16:06:35.119376 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:06:35.121126 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates" rename to "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:06:35.242764 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.120 seconds
[0m16:06:35.257379 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:06:35.259382 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */
alter table "iceberg"."testnamespace"."stg_graduates__dbt_tmp" rename to "iceberg"."testnamespace"."stg_graduates"
[0m16:06:35.492039 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.231 seconds
[0m16:06:35.501881 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:06:35.508750 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_graduates"
[0m16:06:35.509955 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_graduates"} */

    drop table if exists "iceberg"."testnamespace"."stg_graduates__dbt_backup"
[0m16:06:35.644019 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.131 seconds
[0m16:06:35.654190 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: ROLLBACK
[0m16:06:35.656545 [debug] [Thread-1 (]: On model.czech_education.stg_graduates: Close
[0m16:06:35.660552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F622001D0>]}
[0m16:06:35.663554 [info ] [Thread-1 (]: 2 of 6 OK created sql table model testnamespace.stg_graduates .................. [[32mCREATE TABLE (223 rows)[0m in 1.67s]
[0m16:06:35.668557 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m16:06:35.672400 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m16:06:35.677482 [info ] [Thread-1 (]: 3 of 6 START sql table model testnamespace.stg_institutions .................... [RUN]
[0m16:06:35.681548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m16:06:35.684569 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m16:06:35.700132 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m16:06:35.709184 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m16:06:35.734262 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.stg_institutions"
[0m16:06:35.757732 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:06:35.760775 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

  
    

    create table "iceberg"."testnamespace"."stg_institutions__dbt_tmp"
      
      
    as (
      SELECT
    nazev_zar AS institution_name,
    nazev_vs AS university_name,
    druh_vs AS institution_type,
    X, Y
    -- Derive region_code from coordinates (simplified)
    --CASE
    --    WHEN X BETWEEN 1600000 AND 1610000 AND Y BETWEEN 6460000 AND 6470000 THEN 'CZ010'  -- Prague
    --    WHEN X BETWEEN 1590000 AND 1600000 AND Y BETWEEN 6450000 AND 6460000 THEN 'CZ052'  -- Hradec
     --   ELSE 'OTHER'
    --END AS region_code
FROM sqlserver.dbo.institutions
    )
[0m16:06:35.766852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:37.855053 [debug] [Thread-1 (]: SQL status: CREATE TABLE (289 rows) in 2.088 seconds
[0m16:06:37.878020 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:06:37.882019 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions" rename to "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:06:38.083275 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.199 seconds
[0m16:06:38.105403 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:06:38.109262 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */
alter table "iceberg"."testnamespace"."stg_institutions__dbt_tmp" rename to "iceberg"."testnamespace"."stg_institutions"
[0m16:06:38.324745 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.213 seconds
[0m16:06:38.346812 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:06:38.354986 [debug] [Thread-1 (]: Using trino connection "model.czech_education.stg_institutions"
[0m16:06:38.357804 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.stg_institutions"} */

    drop table if exists "iceberg"."testnamespace"."stg_institutions__dbt_backup"
[0m16:06:38.525343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.165 seconds
[0m16:06:38.534939 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: ROLLBACK
[0m16:06:38.536938 [debug] [Thread-1 (]: On model.czech_education.stg_institutions: Close
[0m16:06:38.540937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F624240D0>]}
[0m16:06:38.543937 [info ] [Thread-1 (]: 3 of 6 OK created sql table model testnamespace.stg_institutions ............... [[32mCREATE TABLE (289 rows)[0m in 2.86s]
[0m16:06:38.547942 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m16:06:38.549949 [debug] [Thread-1 (]: Began running node model.czech_education.dimarea
[0m16:06:38.554635 [info ] [Thread-1 (]: 4 of 6 START sql table model testnamespace.dimarea ............................. [RUN]
[0m16:06:38.558612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.dimarea)
[0m16:06:38.560612 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimarea
[0m16:06:38.583783 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimarea"
[0m16:06:38.587324 [debug] [Thread-1 (]: Began executing node model.czech_education.dimarea
[0m16:06:38.605437 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimarea"
[0m16:06:38.623989 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:06:38.625382 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

  
    

    create table "iceberg"."testnamespace"."dimarea__dbt_tmp"
      
      
    as (
      


    SELECT 
        area_code,
        area_name
    FROM "iceberg"."testnamespace"."stg_graduates"
    )
[0m16:06:38.627384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:39.537928 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 0.910 seconds
[0m16:06:39.550153 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:06:39.552151 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea" rename to "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:06:39.709398 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.156 seconds
[0m16:06:39.729604 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:06:39.731606 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */
alter table "iceberg"."testnamespace"."dimarea__dbt_tmp" rename to "iceberg"."testnamespace"."dimarea"
[0m16:06:39.944416 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.210 seconds
[0m16:06:39.960172 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:06:39.966716 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimarea"
[0m16:06:39.968716 [debug] [Thread-1 (]: On model.czech_education.dimarea: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimarea"} */

    drop table if exists "iceberg"."testnamespace"."dimarea__dbt_backup"
[0m16:06:40.089946 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.119 seconds
[0m16:06:40.096021 [debug] [Thread-1 (]: On model.czech_education.dimarea: ROLLBACK
[0m16:06:40.098018 [debug] [Thread-1 (]: On model.czech_education.dimarea: Close
[0m16:06:40.100021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F62426990>]}
[0m16:06:40.103021 [info ] [Thread-1 (]: 4 of 6 OK created sql table model testnamespace.dimarea ........................ [[32mCREATE TABLE (223 rows)[0m in 1.54s]
[0m16:06:40.107027 [debug] [Thread-1 (]: Finished running node model.czech_education.dimarea
[0m16:06:40.108915 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m16:06:40.110928 [info ] [Thread-1 (]: 5 of 6 START sql table model testnamespace.fct_regional_education .............. [RUN]
[0m16:06:40.113928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.dimarea, now model.czech_education.fct_regional_education)
[0m16:06:40.115932 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m16:06:40.132074 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m16:06:40.135928 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m16:06:40.148110 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.fct_regional_education"
[0m16:06:40.161989 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:06:40.164223 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

  
    

    create table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp"
      
      
    as (
      WITH grads_by_region AS (
    SELECT
        area_code,
        university_name,
        SUM(graduate_count) AS total_graduates,
        COUNT(DISTINCT study_program_name) AS num_fields
    FROM "iceberg"."testnamespace"."stg_graduates"
    GROUP BY 1,2
),
institutions_by_region AS (
    SELECT
        --region_code,
        university_name,
        COUNT(*) AS institution_count
    FROM "iceberg"."testnamespace"."stg_institutions"
    GROUP BY 1 
)

SELECT
    g.area_code region_code,
    i.institution_count,
    g.total_graduates,
    g.num_fields,
    -- Add population later if available
    CURRENT_TIMESTAMP AS dbt_updated_at
FROM institutions_by_region i
LEFT JOIN grads_by_region g ON g.university_name=i.university_name
    )
[0m16:06:40.166985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:42.149511 [debug] [Thread-1 (]: SQL status: CREATE TABLE (32 rows) in 1.982 seconds
[0m16:06:42.163394 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:06:42.164396 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education" rename to "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:06:42.278847 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.113 seconds
[0m16:06:42.295033 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:06:42.296784 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */
alter table "iceberg"."testnamespace"."fct_regional_education__dbt_tmp" rename to "iceberg"."testnamespace"."fct_regional_education"
[0m16:06:42.506984 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.208 seconds
[0m16:06:42.526170 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:06:42.529929 [debug] [Thread-1 (]: Using trino connection "model.czech_education.fct_regional_education"
[0m16:06:42.533032 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.fct_regional_education"} */

    drop table if exists "iceberg"."testnamespace"."fct_regional_education__dbt_backup"
[0m16:06:42.616327 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.080 seconds
[0m16:06:42.625014 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: ROLLBACK
[0m16:06:42.627015 [debug] [Thread-1 (]: On model.czech_education.fct_regional_education: Close
[0m16:06:42.631015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F60BE5210>]}
[0m16:06:42.634012 [info ] [Thread-1 (]: 5 of 6 OK created sql table model testnamespace.fct_regional_education ......... [[32mCREATE TABLE (32 rows)[0m in 2.52s]
[0m16:06:42.638020 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m16:06:42.639113 [debug] [Thread-1 (]: Began running node model.czech_education.dimareascd
[0m16:06:42.642478 [info ] [Thread-1 (]: 6 of 6 START sql table model testnamespace.dimareascd .......................... [RUN]
[0m16:06:42.645912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.fct_regional_education, now model.czech_education.dimareascd)
[0m16:06:42.647905 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimareascd
[0m16:06:42.657004 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimareascd"
[0m16:06:42.660005 [debug] [Thread-1 (]: Began executing node model.czech_education.dimareascd
[0m16:06:42.674005 [debug] [Thread-1 (]: Writing runtime sql for node "model.czech_education.dimareascd"
[0m16:06:42.683291 [debug] [Thread-1 (]: Using trino connection "model.czech_education.dimareascd"
[0m16:06:42.686291 [debug] [Thread-1 (]: On model.czech_education.dimareascd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "node_id": "model.czech_education.dimareascd"} */

  
    

    create table "iceberg"."testnamespace"."dimareascd"
      
      
    as (
      -- models/dim/dim_product_history.sql
SELECT 
    area_code,
    area_name,
    dbt_valid_from as effective_date,
    dbt_valid_to as expiry_date,
    CASE 
        WHEN dbt_valid_to IS NULL THEN 1 
        ELSE 0 
    END as is_current
FROM "iceberg"."snapshots"."area_scd"
ORDER BY   area_code , effective_date
    )
[0m16:06:42.689871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:43.817405 [debug] [Thread-1 (]: SQL status: CREATE TABLE (223 rows) in 1.127 seconds
[0m16:06:43.827116 [debug] [Thread-1 (]: On model.czech_education.dimareascd: ROLLBACK
[0m16:06:43.829064 [debug] [Thread-1 (]: On model.czech_education.dimareascd: Close
[0m16:06:43.832061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c42b9439-0a78-4772-8153-8aab54847a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F62309090>]}
[0m16:06:43.836134 [info ] [Thread-1 (]: 6 of 6 OK created sql table model testnamespace.dimareascd ..................... [[32mCREATE TABLE (223 rows)[0m in 1.19s]
[0m16:06:43.840421 [debug] [Thread-1 (]: Finished running node model.czech_education.dimareascd
[0m16:06:43.846154 [debug] [MainThread]: On master: COMMIT
[0m16:06:43.849016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:43.851136 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m16:06:43.853105 [debug] [MainThread]: Connection 'list_iceberg_testnamespace' was properly closed.
[0m16:06:43.856031 [debug] [MainThread]: Connection 'model.czech_education.dimareascd' was properly closed.
[0m16:06:43.858281 [info ] [MainThread]: 
[0m16:06:43.860033 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 13.51 seconds (13.51s).
[0m16:06:43.867030 [debug] [MainThread]: Command end result
[0m16:06:43.967237 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:06:43.978593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:06:43.998627 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m16:06:43.999637 [info ] [MainThread]: 
[0m16:06:44.002352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:44.008282 [info ] [MainThread]: 
[0m16:06:44.013640 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:06:44.017639 [debug] [MainThread]: Command `dbt run` succeeded at 16:06:44.016638 after 18.52 seconds
[0m16:06:44.019638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F602341D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F59EFBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F59E758D0>]}
[0m16:06:44.023643 [debug] [MainThread]: Flushing usage events
[0m16:06:46.110622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:10.482153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213377665D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021337350BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213377A6F90>]}


============================== 16:07:10.500992 | 65923065-e923-46ab-8ebf-a55bfa77bf67 ==============================
[0m16:07:10.500992 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:07:10.504992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:07:13.014394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65923065-e923-46ab-8ebf-a55bfa77bf67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213377E2310>]}
[0m16:07:13.306377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65923065-e923-46ab-8ebf-a55bfa77bf67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133444D790>]}
[0m16:07:13.309343 [info ] [MainThread]: Registered adapter: trino=1.9.3
[0m16:07:14.350969 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:07:15.199756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:15.202941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:15.421953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65923065-e923-46ab-8ebf-a55bfa77bf67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021337B84750>]}
[0m16:07:15.492867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65923065-e923-46ab-8ebf-a55bfa77bf67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021339117690>]}
[0m16:07:15.498590 [info ] [MainThread]: Found 6 models, 1 snapshot, 455 macros, 2 semantic models
[0m16:07:15.501250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65923065-e923-46ab-8ebf-a55bfa77bf67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021338F00490>]}
[0m16:07:15.511614 [info ] [MainThread]: 
[0m16:07:15.514235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:07:15.518222 [info ] [MainThread]: 
[0m16:07:15.522218 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:07:15.551405 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_testnamespace'
[0m16:07:16.722750 [debug] [ThreadPool]: Using trino connection "list_iceberg_testnamespace"
[0m16:07:16.727742 [debug] [ThreadPool]: On list_iceberg_testnamespace: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_testnamespace"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'testnamespace') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'testnamespace'
[0m16:07:16.732000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:16.735032 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m16:07:16.742421 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '65923065-e923-46ab-8ebf-a55bfa77bf67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021339126090>]}
[0m16:07:17.316441 [debug] [ThreadPool]: SQL status: SUCCESS in 0.584 seconds
[0m16:07:17.319962 [debug] [ThreadPool]: On list_iceberg_testnamespace: ROLLBACK
[0m16:07:17.321430 [debug] [ThreadPool]: On list_iceberg_testnamespace: Close
[0m16:07:17.324174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_testnamespace, now list_iceberg_snapshots)
[0m16:07:17.334623 [debug] [ThreadPool]: Using trino connection "list_iceberg_snapshots"
[0m16:07:17.339248 [debug] [ThreadPool]: On list_iceberg_snapshots: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "list_iceberg_snapshots"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'snapshots') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'snapshots'
[0m16:07:17.340246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:17.483988 [debug] [ThreadPool]: SQL status: SUCCESS in 0.143 seconds
[0m16:07:17.486982 [debug] [ThreadPool]: On list_iceberg_snapshots: ROLLBACK
[0m16:07:17.488983 [debug] [ThreadPool]: On list_iceberg_snapshots: Close
[0m16:07:17.492134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65923065-e923-46ab-8ebf-a55bfa77bf67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021337CE0350>]}
[0m16:07:17.501668 [debug] [Thread-1 (]: Began running node model.czech_education.spine
[0m16:07:17.504192 [debug] [Thread-1 (]: Acquiring new trino connection 'model.czech_education.spine'
[0m16:07:17.505191 [debug] [Thread-1 (]: Began compiling node model.czech_education.spine
[0m16:07:17.511310 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.spine"
[0m16:07:17.513314 [debug] [Thread-1 (]: Began executing node model.czech_education.spine
[0m16:07:17.514317 [debug] [Thread-1 (]: Finished running node model.czech_education.spine
[0m16:07:17.515973 [debug] [Thread-1 (]: Began running node model.czech_education.stg_graduates
[0m16:07:17.517317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.spine, now model.czech_education.stg_graduates)
[0m16:07:17.518312 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_graduates
[0m16:07:17.522312 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_graduates"
[0m16:07:17.525318 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_graduates
[0m16:07:17.528316 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_graduates
[0m16:07:17.529315 [debug] [Thread-1 (]: Began running node model.czech_education.stg_institutions
[0m16:07:17.530313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_graduates, now model.czech_education.stg_institutions)
[0m16:07:17.531312 [debug] [Thread-1 (]: Began compiling node model.czech_education.stg_institutions
[0m16:07:17.535838 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.stg_institutions"
[0m16:07:17.537839 [debug] [Thread-1 (]: Began executing node model.czech_education.stg_institutions
[0m16:07:17.538839 [debug] [Thread-1 (]: Finished running node model.czech_education.stg_institutions
[0m16:07:17.540706 [debug] [Thread-1 (]: Began running node model.czech_education.dimarea
[0m16:07:17.542225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.stg_institutions, now model.czech_education.dimarea)
[0m16:07:17.543377 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimarea
[0m16:07:17.550225 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimarea"
[0m16:07:17.552573 [debug] [Thread-1 (]: Began executing node model.czech_education.dimarea
[0m16:07:17.554226 [debug] [Thread-1 (]: Finished running node model.czech_education.dimarea
[0m16:07:17.556231 [debug] [Thread-1 (]: Began running node model.czech_education.fct_regional_education
[0m16:07:17.557324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.dimarea, now model.czech_education.fct_regional_education)
[0m16:07:17.558226 [debug] [Thread-1 (]: Began compiling node model.czech_education.fct_regional_education
[0m16:07:17.565227 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.fct_regional_education"
[0m16:07:17.568228 [debug] [Thread-1 (]: Began executing node model.czech_education.fct_regional_education
[0m16:07:17.570229 [debug] [Thread-1 (]: Finished running node model.czech_education.fct_regional_education
[0m16:07:17.571639 [debug] [Thread-1 (]: Began running node snapshot.czech_education.area_scd
[0m16:07:17.573231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.czech_education.fct_regional_education, now snapshot.czech_education.area_scd)
[0m16:07:17.574529 [debug] [Thread-1 (]: Began compiling node snapshot.czech_education.area_scd
[0m16:07:17.583228 [debug] [Thread-1 (]: Began executing node snapshot.czech_education.area_scd
[0m16:07:17.585227 [debug] [Thread-1 (]: Finished running node snapshot.czech_education.area_scd
[0m16:07:17.587230 [debug] [Thread-1 (]: Began running node model.czech_education.dimareascd
[0m16:07:17.589226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.czech_education.area_scd, now model.czech_education.dimareascd)
[0m16:07:17.590561 [debug] [Thread-1 (]: Began compiling node model.czech_education.dimareascd
[0m16:07:17.597230 [debug] [Thread-1 (]: Writing injected SQL for node "model.czech_education.dimareascd"
[0m16:07:17.600409 [debug] [Thread-1 (]: Began executing node model.czech_education.dimareascd
[0m16:07:17.603229 [debug] [Thread-1 (]: Finished running node model.czech_education.dimareascd
[0m16:07:17.607169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:17.608975 [debug] [MainThread]: Connection 'list_iceberg_snapshots' was properly closed.
[0m16:07:17.609975 [debug] [MainThread]: Connection 'model.czech_education.dimareascd' was properly closed.
[0m16:07:17.609975 [debug] [MainThread]: Command end result
[0m16:07:17.921907 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:07:17.935919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:07:17.957580 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\github\czech-education-analytics\dbt_project\target\run_results.json
[0m16:07:17.967791 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m16:07:17.968834 [info ] [MainThread]: Building catalog
[0m16:07:17.979808 [debug] [ThreadPool]: Acquiring new trino connection 'iceberg.information_schema'
[0m16:07:18.171448 [debug] [ThreadPool]: Using trino connection "iceberg.information_schema"
[0m16:07:18.171448 [debug] [ThreadPool]: On iceberg.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "czech_education", "target_name": "dev", "connection_name": "iceberg.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "iceberg".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'dimarea'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'stg_graduates'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'stg_institutions'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'fct_regional_education'
                    )
                 or 
                    (
                        table_schema = 'snapshots'
                        and table_name = 'area_scd'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'dimareascd'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'spine'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "iceberg".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'dimarea'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'stg_graduates'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'stg_institutions'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'fct_regional_education'
                    )
                 or 
                    (
                        table_schema = 'snapshots'
                        and table_name = 'area_scd'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'dimareascd'
                    )
                 or 
                    (
                        table_schema = 'testnamespace'
                        and table_name = 'spine'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'testnamespace'
                    and table_name = 'dimarea'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'testnamespace'
                    and table_name = 'stg_graduates'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'testnamespace'
                    and table_name = 'stg_institutions'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'testnamespace'
                    and table_name = 'fct_regional_education'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'snapshots'
                    and table_name = 'area_scd'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'testnamespace'
                    and table_name = 'dimareascd'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'testnamespace'
                    and table_name = 'spine'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m16:07:18.171448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:20.244159 [debug] [ThreadPool]: SQL status: SUCCESS in 2.065 seconds
[0m16:07:20.260961 [debug] [ThreadPool]: On iceberg.information_schema: Close
[0m16:07:20.289426 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\github\czech-education-analytics\dbt_project\target\catalog.json
[0m16:07:20.337471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\github\czech-education-analytics\dbt_project\target\manifest.json
[0m16:07:20.344685 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\github\czech-education-analytics\dbt_project\target\semantic_manifest.json
[0m16:07:20.346111 [info ] [MainThread]: Catalog written to C:\github\czech-education-analytics\dbt_project\target\catalog.json
[0m16:07:20.351111 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:07:20.350166 after 10.19 seconds
[0m16:07:20.353645 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:07:20.356121 [debug] [MainThread]: Connection 'iceberg.information_schema' was properly closed.
[0m16:07:20.358115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021330D74C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021330FB59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213370D7450>]}
[0m16:07:20.359114 [debug] [MainThread]: Flushing usage events
[0m16:07:22.230749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:41.417153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F4244BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F41051D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F4245510>]}


============================== 16:07:41.433275 | cba5e0db-fb28-4b34-90ba-60ac2ce69287 ==============================
[0m16:07:41.433275 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:07:41.437333 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\mikev\\.dbt', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\github\\czech-education-analytics\\dbt_project\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs serve', 'printer_width': '80', 'target_path': 'None'}
[0m16:07:43.543002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba5e0db-fb28-4b34-90ba-60ac2ce69287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F47138D0>]}
[0m16:07:43.794696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cba5e0db-fb28-4b34-90ba-60ac2ce69287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F0F34D90>]}
[0m16:07:44.618276 [error] [MainThread]: Encountered an error:
[WinError 10013] Došlo k pokusu o přístup k soketu způsobem zakázaným jeho přístupovými oprávněními
[0m16:07:44.642279 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\mikev\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mikev\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mikev\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mikev\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mikev\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mikev\anaconda3\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\mikev\anaconda3\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mikev\anaconda3\Lib\socketserver.py", line 456, in __init__
    self.server_bind()
  File "C:\Users\mikev\anaconda3\Lib\socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
PermissionError: [WinError 10013] Došlo k pokusu o přístup k soketu způsobem zakázaným jeho přístupovými oprávněními

[0m16:07:44.666976 [debug] [MainThread]: Command `dbt docs serve` failed at 16:07:44.665978 after 3.56 seconds
[0m16:07:44.670979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F424C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F42E6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F47AF2D0>]}
[0m16:07:44.673979 [debug] [MainThread]: Flushing usage events
[0m16:07:47.117515 [debug] [MainThread]: An error was encountered while trying to flush usage events
